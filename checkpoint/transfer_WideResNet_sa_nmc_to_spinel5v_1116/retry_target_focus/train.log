11-16 15:07:25 data_name: Battery_inconsistent
11-16 15:07:25 data_dir: ./my_datasets/Battery
11-16 15:07:25 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 15:07:25 normlizetype: mean-std
11-16 15:07:25 method: sngp
11-16 15:07:25 gp_hidden_dim: 2048
11-16 15:07:25 spectral_norm_bound: 0.95
11-16 15:07:25 n_power_iterations: 1
11-16 15:07:25 nesterov: True
11-16 15:07:25 print_freq: 10
11-16 15:07:25 layers: 16
11-16 15:07:25 widen_factor: 1
11-16 15:07:25 droprate: 0.3
11-16 15:07:25 cuda_device: 0
11-16 15:07:25 checkpoint_dir: ./checkpoint
11-16 15:07:25 pretrained: True
11-16 15:07:25 batch_size: 64
11-16 15:07:25 num_workers: 0
11-16 15:07:25 bottleneck: True
11-16 15:07:25 bottleneck_num: 128
11-16 15:07:25 last_batch: False
11-16 15:07:25 hidden_size: 1024
11-16 15:07:25 trade_off_adversarial: Step
11-16 15:07:25 lam_adversarial: 1
11-16 15:07:25 opt: adam
11-16 15:07:25 lr: 0.0005
11-16 15:07:25 momentum: 0.9
11-16 15:07:25 weight_decay: 1e-05
11-16 15:07:25 lr_scheduler: step
11-16 15:07:25 gamma: 0.1
11-16 15:07:25 steps: 150, 250
11-16 15:07:25 middle_epoch: 15
11-16 15:07:25 max_epoch: 62
11-16 15:07:25 print_step: 25
11-16 15:07:25 inconsistent: UAN
11-16 15:07:25 model_name: WideResNet_sa
11-16 15:07:25 th: 0.5
11-16 15:07:25 input_channels: 22
11-16 15:07:25 classification_label: eol_class
11-16 15:07:25 sequence_length: 32
11-16 15:07:25 cycles_per_file: 50
11-16 15:07:25 sample_random_state: 42
11-16 15:07:25 transfer_task: [[0], [1]]
11-16 15:07:25 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 15:07:25 target_cathode: ['5Vspinel']
11-16 15:07:25 num_classes: 5
11-16 15:07:25 domain_temperature: 1.0
11-16 15:07:25 class_temperature: 10.0
11-16 15:07:25 lambda_src: 0.0
11-16 15:07:25 lambda_src_decay_patience: 2
11-16 15:07:25 lambda_src_decay_factor: 0.5
11-16 15:07:25 lambda_src_min: 0.0
11-16 15:07:25 lambda_src_warmup: 0
11-16 15:07:25 improvement_metric: common
11-16 15:07:25 auto_select: True
11-16 15:07:25 llm_compare: True
11-16 15:07:25 llm_backend: openai
11-16 15:07:25 llm_model: None
11-16 15:07:25 llm_context: 
11-16 15:07:25 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 15:07:25 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention ideal to capture local and some longer-range dependencies without excessive memory use. Label inconsistency suggests avoiding openmax or unknown heads to reduce tuning complexity. Moderate dropout (0.3) helps prevent overfitting given small data and attention. Batch size 64 balances GPU efficiency and stable training. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention ideal to capture local and some longer-range dependencies without excessive memory use. Label inconsistency suggests avoiding openmax or unknown heads to reduce tuning complexity. Moderate dropout (0.3) helps prevent overfitting given small data and attention. Batch size 64 balances GPU efficiency and stable training."\n}'}
11-16 15:07:25 llm_cfg_stamp: 20251116_144741
11-16 15:07:25 tag: sngp_wrn_sa_20251116_144741
11-16 15:07:25 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 15:07:25 dataset_cycle_stats: {'source_train_cycles': 8250, 'source_val_cycles': 3200, 'source_val_has_holdout': True, 'target_train_cycles': 2050, 'target_val_cycles': 600, 'target_val_has_holdout': True, 'source_train_sequences': 3135, 'source_val_sequences': 1216, 'target_train_sequences': 779, 'target_val_sequences': 228, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 50}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 50}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 50}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 50}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 50}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 50}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 50}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 50}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 50}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 50}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 50}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 50}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 50}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 50}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 50}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 50}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 50}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 50}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 50}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 50}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 50}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 50}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 50}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 50}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 50}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 50}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 50}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 50}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 50}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 50}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 50}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 50}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 50}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 50}]}}}
11-16 15:07:25 input_size: 32
11-16 15:07:25 reinit_head: False
11-16 15:07:25 using 1 cpu
11-16 15:07:25 Uncaught exception in ZMQStream callback
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed
11-16 15:07:25 Uncaught exception in zmqstream callback
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 610, in _handle_events
    self._handle_recv()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 639, in _handle_recv
    self._run_callback(callback, msg)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed
11-16 15:07:25 Exception in callback BaseAsyncIOLoop._handle_events(43, 1)
handle: <Handle BaseAsyncIOLoop._handle_events(43, 1)>
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/platform/asyncio.py", line 202, in _handle_events
    handler_func(fileobj, events)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 610, in _handle_events
    self._handle_recv()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 639, in _handle_recv
    self._run_callback(callback, msg)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 1094-1095: surrogates not allowed
11-16 19:31:37 data_name: Battery_inconsistent
11-16 19:31:37 data_dir: ./my_datasets/Battery
11-16 19:31:37 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 19:31:37 normlizetype: mean-std
11-16 19:31:37 method: sngp
11-16 19:31:37 gp_hidden_dim: 2048
11-16 19:31:37 spectral_norm_bound: 0.95
11-16 19:31:37 n_power_iterations: 1
11-16 19:31:37 nesterov: True
11-16 19:31:37 print_freq: 10
11-16 19:31:37 layers: 16
11-16 19:31:37 widen_factor: 1
11-16 19:31:37 droprate: 0.3
11-16 19:31:37 cuda_device: 0
11-16 19:31:37 checkpoint_dir: ./checkpoint
11-16 19:31:37 pretrained: True
11-16 19:31:37 batch_size: 64
11-16 19:31:37 num_workers: 0
11-16 19:31:37 bottleneck: True
11-16 19:31:37 bottleneck_num: 128
11-16 19:31:37 last_batch: False
11-16 19:31:37 hidden_size: 1024
11-16 19:31:37 trade_off_adversarial: Step
11-16 19:31:37 lam_adversarial: 1
11-16 19:31:37 opt: adam
11-16 19:31:37 lr: 5e-05
11-16 19:31:37 momentum: 0.9
11-16 19:31:37 weight_decay: 1e-05
11-16 19:31:37 lr_scheduler: step
11-16 19:31:37 gamma: 0.1
11-16 19:31:37 steps: 150, 250
11-16 19:31:37 middle_epoch: 15
11-16 19:31:37 max_epoch: 62
11-16 19:31:37 print_step: 25
11-16 19:31:37 inconsistent: UAN
11-16 19:31:37 model_name: WideResNet_sa
11-16 19:31:37 th: 0.5
11-16 19:31:37 input_channels: 22
11-16 19:31:37 classification_label: eol_class
11-16 19:31:37 sequence_length: 32
11-16 19:31:37 cycles_per_file: 20
11-16 19:31:37 sample_random_state: 42
11-16 19:31:37 transfer_task: [[0], [1]]
11-16 19:31:37 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 19:31:37 target_cathode: ['5Vspinel']
11-16 19:31:37 num_classes: 5
11-16 19:31:37 domain_temperature: 1.0
11-16 19:31:37 class_temperature: 10.0
11-16 19:31:37 lambda_src: 0.0
11-16 19:31:37 lambda_src_decay_patience: 2
11-16 19:31:37 lambda_src_decay_factor: 0.5
11-16 19:31:37 lambda_src_min: 0.0
11-16 19:31:37 lambda_src_warmup: 0
11-16 19:31:37 improvement_metric: common
11-16 19:31:37 auto_select: True
11-16 19:31:37 llm_compare: True
11-16 19:31:37 llm_backend: openai
11-16 19:31:37 llm_model: None
11-16 19:31:37 llm_context: 
11-16 19:31:37 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 19:31:37 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32 steps) and 7 channels, making a lightweight CNN with self-attention ideal to capture local features and some long-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity. Dropout at 0.3 balances overfitting risk from attention layers on a small dataset. Batch size 64 and learning rate 0.001 align with hints and ensure stable training. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32 steps) and 7 channels, making a lightweight CNN with self-attention ideal to capture local features and some long-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity. Dropout at 0.3 balances overfitting risk from attention layers on a small dataset. Batch size 64 and learning rate 0.001 align with hints and ensure stable training."\n}'}
11-16 19:31:37 llm_cfg_stamp: 20251116_192719
11-16 19:31:37 tag: sngp_wrn_sa_20251116_192719
11-16 19:31:37 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 19:31:37 dataset_cycle_stats: {'source_train_cycles': 3300, 'source_val_cycles': 1280, 'source_val_has_holdout': True, 'target_train_cycles': 820, 'target_val_cycles': 240, 'target_val_has_holdout': True, 'source_train_sequences': 165, 'source_val_sequences': 64, 'target_train_sequences': 41, 'target_val_sequences': 12, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 20, 'total_cycles': 1121}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 20, 'total_cycles': 516}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 20, 'total_cycles': 1021}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 20, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 20, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 20, 'total_cycles': 852}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 20, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 20, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 20, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 20, 'total_cycles': 180}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 20, 'total_cycles': 1528}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 20, 'total_cycles': 216}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 20, 'total_cycles': 1415}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 20, 'total_cycles': 1493}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 20, 'total_cycles': 1273}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 20, 'total_cycles': 1222}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 20, 'total_cycles': 704}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 20, 'total_cycles': 710}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 20, 'total_cycles': 712}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 20, 'total_cycles': 168}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 20, 'total_cycles': 1309}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 20, 'total_cycles': 1121}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 20, 'total_cycles': 1122}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 20, 'total_cycles': 1079}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 20, 'total_cycles': 1080}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 20, 'total_cycles': 358}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 20, 'total_cycles': 1023}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 20, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 20, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 20, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 20, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 20, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 20, 'total_cycles': 628}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 20, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 20, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 20, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 20, 'total_cycles': 1946}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 20, 'total_cycles': 2145}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 20, 'total_cycles': 2146}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 20, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 20, 'total_cycles': 932}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 20, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 20, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 20, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 20, 'total_cycles': 621}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 20, 'total_cycles': 618}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 20, 'total_cycles': 620}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 20, 'total_cycles': 940}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 20, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 20, 'total_cycles': 942}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 20, 'total_cycles': 979}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 20, 'total_cycles': 939}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 20, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 20, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 20, 'total_cycles': 789}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 20, 'total_cycles': 620}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 20, 'total_cycles': 618}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 20, 'total_cycles': 2325}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 20, 'total_cycles': 946}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 20, 'total_cycles': 195}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 20, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 20, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 20, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 20, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 20, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 20, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 20, 'total_cycles': 195}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 20, 'total_cycles': 196}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 20, 'total_cycles': 195}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 20, 'total_cycles': 188}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 20, 'total_cycles': 257}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 20, 'total_cycles': 251}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 20, 'total_cycles': 257}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 20, 'total_cycles': 606}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 20, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 20, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 20, 'total_cycles': 620}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 20, 'total_cycles': 635}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 20, 'total_cycles': 602}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 20, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 20, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 20, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 20, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 20, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 20, 'total_cycles': 1557}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 20, 'total_cycles': 1608}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 20, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 20, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 20, 'total_cycles': 532}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 20, 'total_cycles': 788}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 20, 'total_cycles': 1109}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 20, 'total_cycles': 1147}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 20, 'total_cycles': 716}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 20, 'total_cycles': 1318}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 20, 'total_cycles': 1221}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 20, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 20, 'total_cycles': 1766}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 20, 'total_cycles': 180}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 20, 'total_cycles': 516}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 20, 'total_cycles': 1123}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 20, 'total_cycles': 1425}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 20, 'total_cycles': 1424}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 20, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 20, 'total_cycles': 1024}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 20, 'total_cycles': 371}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 20, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 20, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 20, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 20, 'total_cycles': 2148}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 20, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 20, 'total_cycles': 171}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 20, 'total_cycles': 789}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 20, 'total_cycles': 944}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 20, 'total_cycles': 619}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 20, 'total_cycles': 939}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 20, 'total_cycles': 1045}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 20, 'total_cycles': 169}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 20, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 20, 'total_cycles': 2325}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 20, 'total_cycles': 2324}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 20, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 20, 'total_cycles': 600}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 20, 'total_cycles': 606}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 20, 'total_cycles': 1004}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 20, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 20, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 20, 'total_cycles': 251}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 20, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 20, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 20, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 20, 'total_cycles': 1495}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 20, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 20, 'total_cycles': 1494}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 20, 'total_cycles': 533}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 20, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 20, 'total_cycles': 788}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 20, 'total_cycles': 216}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 20, 'total_cycles': 846}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 20, 'total_cycles': 855}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 20, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 20, 'total_cycles': 2028}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 20, 'total_cycles': 421}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 20, 'total_cycles': 687}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 20, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 20, 'total_cycles': 2028}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 20, 'total_cycles': 220}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 20, 'total_cycles': 421}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 20, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 20, 'total_cycles': 421}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 20, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 20, 'total_cycles': 820}]}}}
11-16 19:31:37 input_size: 32
11-16 19:31:37 reinit_head: False
11-16 19:31:37 using 1 cpu
11-16 19:31:37 Reducing learning rate to 5e-05 for 41 target samples
11-16 19:31:37 Freezing early layers of backbone for 41 target samples
11-16 19:31:37 Exception in callback functools.partial(<bound method OutStream._flush of <spyder_kernels.console.outstream.TTYOutStream object at 0x172cdca90>>)
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/ioloop.py", line 750, in _run_callback
    ret = callback()
          ^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed
11-16 20:26:40 data_name: Battery_inconsistent
11-16 20:26:40 data_dir: ./my_datasets/Battery
11-16 20:26:40 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 20:26:40 normlizetype: mean-std
11-16 20:26:40 method: sngp
11-16 20:26:40 gp_hidden_dim: 2048
11-16 20:26:40 spectral_norm_bound: 0.95
11-16 20:26:40 n_power_iterations: 1
11-16 20:26:40 nesterov: True
11-16 20:26:40 print_freq: 10
11-16 20:26:40 layers: 16
11-16 20:26:40 widen_factor: 1
11-16 20:26:40 droprate: 0.3
11-16 20:26:40 cuda_device: 0
11-16 20:26:40 checkpoint_dir: ./checkpoint
11-16 20:26:40 pretrained: True
11-16 20:26:40 batch_size: 64
11-16 20:26:40 num_workers: 0
11-16 20:26:40 bottleneck: True
11-16 20:26:40 bottleneck_num: 128
11-16 20:26:40 last_batch: False
11-16 20:26:40 hidden_size: 1024
11-16 20:26:40 trade_off_adversarial: Step
11-16 20:26:40 lam_adversarial: 1
11-16 20:26:40 opt: adam
11-16 20:26:40 lr: 5e-05
11-16 20:26:40 momentum: 0.9
11-16 20:26:40 weight_decay: 1e-05
11-16 20:26:40 lr_scheduler: step
11-16 20:26:40 gamma: 0.1
11-16 20:26:40 steps: 150, 250
11-16 20:26:40 middle_epoch: 15
11-16 20:26:40 max_epoch: 62
11-16 20:26:40 print_step: 25
11-16 20:26:40 inconsistent: UAN
11-16 20:26:40 model_name: WideResNet_sa
11-16 20:26:40 th: 0.5
11-16 20:26:40 input_channels: 22
11-16 20:26:40 classification_label: eol_class
11-16 20:26:40 sequence_length: 32
11-16 20:26:40 cycles_per_file: 5
11-16 20:26:40 sample_random_state: 42
11-16 20:26:40 transfer_task: [[0], [1]]
11-16 20:26:40 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 20:26:40 target_cathode: ['5Vspinel']
11-16 20:26:40 num_classes: 5
11-16 20:26:40 domain_temperature: 1.0
11-16 20:26:40 class_temperature: 10.0
11-16 20:26:40 lambda_src: 0.0
11-16 20:26:40 lambda_src_decay_patience: 2
11-16 20:26:40 lambda_src_decay_factor: 0.5
11-16 20:26:40 lambda_src_min: 0.0
11-16 20:26:40 lambda_src_warmup: 0
11-16 20:26:40 improvement_metric: common
11-16 20:26:40 auto_select: True
11-16 20:26:40 llm_compare: True
11-16 20:26:40 llm_backend: openai
11-16 20:26:40 llm_model: None
11-16 20:26:40 llm_context: 
11-16 20:26:40 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 20:26:40 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention ideal to capture local features and some long-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and overfitting risk. Moderate bottleneck and dropout balance capacity and regularization. The learning rate and batch size align with hints for stable training on this battery dataset. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention ideal to capture local features and some long-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and overfitting risk. Moderate bottleneck and dropout balance capacity and regularization. The learning rate and batch size align with hints for stable training on this battery dataset."\n}'}
11-16 20:26:40 llm_cfg_stamp: 20251116_202238
11-16 20:26:40 tag: sngp_wrn_sa_20251116_202238
11-16 20:26:40 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 20:26:40 dataset_cycle_stats: {'source_train_cycles': 825, 'source_val_cycles': 320, 'source_val_has_holdout': True, 'target_train_cycles': 205, 'target_val_cycles': 60, 'target_val_has_holdout': True, 'source_train_sequences': 165, 'source_val_sequences': 64, 'target_train_sequences': 41, 'target_val_sequences': 12, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 5, 'total_cycles': 1021}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 5, 'total_cycles': 852}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 5, 'total_cycles': 1528}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 5, 'total_cycles': 1415}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 5, 'total_cycles': 1493}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 5, 'total_cycles': 1273}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 5, 'total_cycles': 1222}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 5, 'total_cycles': 704}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 5, 'total_cycles': 710}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 5, 'total_cycles': 712}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 5, 'total_cycles': 168}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 5, 'total_cycles': 1309}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 5, 'total_cycles': 1122}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 5, 'total_cycles': 1079}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 5, 'total_cycles': 1080}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 5, 'total_cycles': 358}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 5, 'total_cycles': 1023}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 5, 'total_cycles': 1946}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 5, 'total_cycles': 2145}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 5, 'total_cycles': 2146}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 5, 'total_cycles': 932}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 5, 'total_cycles': 621}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 5, 'total_cycles': 940}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 5, 'total_cycles': 942}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 5, 'total_cycles': 979}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 5, 'total_cycles': 946}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 5, 'total_cycles': 196}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 5, 'total_cycles': 188}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 5, 'total_cycles': 635}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 5, 'total_cycles': 602}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 5, 'total_cycles': 1557}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 5, 'total_cycles': 1608}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 5, 'total_cycles': 788}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 5, 'total_cycles': 1109}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 5, 'total_cycles': 1147}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 5, 'total_cycles': 716}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 5, 'total_cycles': 1318}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 5, 'total_cycles': 1221}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 5, 'total_cycles': 1766}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 5, 'total_cycles': 1123}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 5, 'total_cycles': 1425}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 5, 'total_cycles': 1024}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 5, 'total_cycles': 371}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 5, 'total_cycles': 2148}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 5, 'total_cycles': 171}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 5, 'total_cycles': 944}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 5, 'total_cycles': 619}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 5, 'total_cycles': 1045}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 5, 'total_cycles': 169}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 5, 'total_cycles': 600}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 5, 'total_cycles': 1004}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 5, 'total_cycles': 533}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 5, 'total_cycles': 846}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 5, 'total_cycles': 855}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 5, 'total_cycles': 687}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 5, 'total_cycles': 220}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 5, 'total_cycles': 820}]}}}
11-16 20:26:40 input_size: 32
11-16 20:26:40 reinit_head: False
11-16 20:26:40 using 1 cpu
11-16 20:26:40 Reducing learning rate to 5e-05 for 41 target samples
11-16 20:26:40 Freezing early layers of backbone for 41 target samples
11-16 20:26:40 Exception in callback functools.partial(<bound method OutStream._flush of <spyder_kernels.console.outstream.TTYOutStream object at 0x172cdca90>>)
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/ioloop.py", line 750, in _run_callback
    ret = callback()
          ^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed
11-16 21:36:59 data_name: Battery_inconsistent
11-16 21:36:59 data_dir: ./my_datasets/Battery
11-16 21:36:59 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 21:36:59 normlizetype: mean-std
11-16 21:36:59 method: sngp
11-16 21:36:59 gp_hidden_dim: 2048
11-16 21:36:59 spectral_norm_bound: 0.95
11-16 21:36:59 n_power_iterations: 1
11-16 21:36:59 nesterov: True
11-16 21:36:59 print_freq: 10
11-16 21:36:59 layers: 16
11-16 21:36:59 widen_factor: 1
11-16 21:36:59 droprate: 0.3
11-16 21:36:59 cuda_device: 0
11-16 21:36:59 checkpoint_dir: ./checkpoint
11-16 21:36:59 pretrained: True
11-16 21:36:59 batch_size: 64
11-16 21:36:59 num_workers: 0
11-16 21:36:59 bottleneck: True
11-16 21:36:59 bottleneck_num: 128
11-16 21:36:59 last_batch: False
11-16 21:36:59 hidden_size: 1024
11-16 21:36:59 trade_off_adversarial: Step
11-16 21:36:59 lam_adversarial: 1
11-16 21:36:59 opt: adam
11-16 21:36:59 lr: 5e-05
11-16 21:36:59 momentum: 0.9
11-16 21:36:59 weight_decay: 1e-05
11-16 21:36:59 lr_scheduler: step
11-16 21:36:59 gamma: 0.1
11-16 21:36:59 steps: 150, 250
11-16 21:36:59 middle_epoch: 15
11-16 21:36:59 max_epoch: 62
11-16 21:36:59 print_step: 25
11-16 21:36:59 inconsistent: UAN
11-16 21:36:59 model_name: WideResNet_sa
11-16 21:36:59 th: 0.5
11-16 21:36:59 input_channels: 21
11-16 21:36:59 classification_label: eol_class
11-16 21:36:59 sequence_length: 32
11-16 21:36:59 cycles_per_file: 5
11-16 21:36:59 sample_random_state: 42
11-16 21:36:59 transfer_task: [[0], [1]]
11-16 21:36:59 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 21:36:59 target_cathode: ['5Vspinel']
11-16 21:36:59 num_classes: 5
11-16 21:36:59 domain_temperature: 1.0
11-16 21:36:59 class_temperature: 10.0
11-16 21:36:59 lambda_src: 0.0
11-16 21:36:59 lambda_src_decay_patience: 2
11-16 21:36:59 lambda_src_decay_factor: 0.5
11-16 21:36:59 lambda_src_min: 0.0
11-16 21:36:59 lambda_src_warmup: 0
11-16 21:36:59 improvement_metric: common
11-16 21:36:59 auto_select: True
11-16 21:36:59 llm_compare: True
11-16 21:36:59 llm_backend: openai
11-16 21:36:59 llm_model: None
11-16 21:36:59 llm_context: 
11-16 21:36:59 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 21:36:59 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32 steps) and 7 channels, suitable for a 1-D CNN with self-attention to capture local and some longer-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and tuning overhead. Dropout at 0.3 balances overfitting risk given the small sequence length and label noise. Batch size 64 and learning rate 0.001 align with typical stable training for this domain. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32 steps) and 7 channels, suitable for a 1-D CNN with self-attention to capture local and some longer-range dependencies. Label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and tuning overhead. Dropout at 0.3 balances overfitting risk given the small sequence length and label noise. Batch size 64 and learning rate 0.001 align with typical stable training for this domain."\n}'}
11-16 21:36:59 llm_cfg_stamp: 20251116_213306
11-16 21:36:59 tag: sngp_wrn_sa_20251116_213306
11-16 21:36:59 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 21:36:59 dataset_cycle_stats: {'source_train_cycles': 825, 'source_val_cycles': 320, 'source_val_has_holdout': True, 'target_train_cycles': 205, 'target_val_cycles': 60, 'target_val_has_holdout': True, 'source_train_sequences': 165, 'source_val_sequences': 64, 'target_train_sequences': 41, 'target_val_sequences': 12, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 5, 'total_cycles': 1021}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 5, 'total_cycles': 852}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 5, 'total_cycles': 1528}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 5, 'total_cycles': 1415}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 5, 'total_cycles': 1493}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 5, 'total_cycles': 1273}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 5, 'total_cycles': 1222}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 5, 'total_cycles': 704}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 5, 'total_cycles': 710}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 5, 'total_cycles': 712}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 5, 'total_cycles': 168}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 5, 'total_cycles': 1309}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 5, 'total_cycles': 1122}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 5, 'total_cycles': 1079}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 5, 'total_cycles': 1080}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 5, 'total_cycles': 358}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 5, 'total_cycles': 1023}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 5, 'total_cycles': 1946}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 5, 'total_cycles': 2145}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 5, 'total_cycles': 2146}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 5, 'total_cycles': 932}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 5, 'total_cycles': 621}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 5, 'total_cycles': 940}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 5, 'total_cycles': 942}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 5, 'total_cycles': 979}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 5, 'total_cycles': 946}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 5, 'total_cycles': 196}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 5, 'total_cycles': 188}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 5, 'total_cycles': 635}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 5, 'total_cycles': 602}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 5, 'total_cycles': 1557}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 5, 'total_cycles': 1608}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 5, 'total_cycles': 788}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 5, 'total_cycles': 1109}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 5, 'total_cycles': 1147}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 5, 'total_cycles': 716}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 5, 'total_cycles': 1318}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 5, 'total_cycles': 1221}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 5, 'total_cycles': 1766}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 5, 'total_cycles': 1123}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 5, 'total_cycles': 1425}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 5, 'total_cycles': 1024}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 5, 'total_cycles': 371}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 5, 'total_cycles': 2148}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 5, 'total_cycles': 171}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 5, 'total_cycles': 944}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 5, 'total_cycles': 619}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 5, 'total_cycles': 1045}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 5, 'total_cycles': 169}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 5, 'total_cycles': 600}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 5, 'total_cycles': 1004}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 5, 'total_cycles': 533}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 5, 'total_cycles': 846}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 5, 'total_cycles': 855}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 5, 'total_cycles': 687}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 5, 'total_cycles': 220}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 5, 'total_cycles': 820}]}}, 'feature_columns': ('cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration', 'capacity_retention', 'energy_retention', 'delta_capacity_discharge', 'delta_energy_discharge', 'delta_cycle_duration', 'rolling_capacity_mean', 'rolling_capacity_std', 'rolling_energy_mean', 'rolling_energy_std', 'rolling_duration_mean', 'duration_ratio', 'coulombic_efficiency', 'energy_efficiency', 'time_per_capacity')}
11-16 21:36:59 input_size: 32
11-16 21:36:59 reinit_head: False
11-16 21:36:59 using 1 cpu
11-16 21:36:59 Reducing learning rate to 5e-05 for 41 target samples
11-16 21:36:59 Freezing early layers of backbone for 41 target samples
11-16 21:36:59 Uncaught exception in ZMQStream callback
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed
11-16 21:36:59 Uncaught exception in zmqstream callback
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 610, in _handle_events
    self._handle_recv()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 639, in _handle_recv
    self._run_callback(callback, msg)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed
11-16 21:36:59 Exception in callback BaseAsyncIOLoop._handle_events(43, 1)
handle: <Handle BaseAsyncIOLoop._handle_events(43, 1)>
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/asyncio/events.py", line 84, in _run
    self._context.run(self._callback, *self._args)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/platform/asyncio.py", line 202, in _handle_events
    handler_func(fileobj, events)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 610, in _handle_events
    self._handle_recv()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 639, in _handle_recv
    self._run_callback(callback, msg)
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/zmq/eventloop/zmqstream.py", line 560, in _run_callback
    f = callback(*args, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 170, in _handle_event
    event_f()
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 134-135: surrogates not allowed
11-16 22:24:36 data_name: Battery_inconsistent
11-16 22:24:36 data_dir: ./my_datasets/Battery
11-16 22:24:36 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 22:24:36 normlizetype: mean-std
11-16 22:24:36 method: sngp
11-16 22:24:36 gp_hidden_dim: 2048
11-16 22:24:36 spectral_norm_bound: 0.95
11-16 22:24:36 n_power_iterations: 1
11-16 22:24:36 nesterov: True
11-16 22:24:36 print_freq: 10
11-16 22:24:36 layers: 16
11-16 22:24:36 widen_factor: 1
11-16 22:24:36 droprate: 0.3
11-16 22:24:36 cuda_device: 0
11-16 22:24:36 checkpoint_dir: ./checkpoint
11-16 22:24:36 pretrained: True
11-16 22:24:36 batch_size: 64
11-16 22:24:36 num_workers: 0
11-16 22:24:36 bottleneck: True
11-16 22:24:36 bottleneck_num: 128
11-16 22:24:36 last_batch: False
11-16 22:24:36 hidden_size: 1024
11-16 22:24:36 trade_off_adversarial: Step
11-16 22:24:36 lam_adversarial: 1
11-16 22:24:36 opt: adam
11-16 22:24:36 lr: 5e-05
11-16 22:24:36 momentum: 0.9
11-16 22:24:36 weight_decay: 1e-05
11-16 22:24:36 lr_scheduler: step
11-16 22:24:36 gamma: 0.1
11-16 22:24:36 steps: 150, 250
11-16 22:24:36 middle_epoch: 15
11-16 22:24:36 max_epoch: 62
11-16 22:24:36 print_step: 25
11-16 22:24:36 inconsistent: UAN
11-16 22:24:36 model_name: WideResNet_sa
11-16 22:24:36 th: 0.5
11-16 22:24:36 input_channels: 21
11-16 22:24:36 classification_label: eol_class
11-16 22:24:36 sequence_length: 32
11-16 22:24:36 cycles_per_file: 5
11-16 22:24:36 sample_random_state: 42
11-16 22:24:36 transfer_task: [[0], [1]]
11-16 22:24:36 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 22:24:36 target_cathode: ['5Vspinel']
11-16 22:24:36 num_classes: 5
11-16 22:24:36 domain_temperature: 1.0
11-16 22:24:36 class_temperature: 10.0
11-16 22:24:36 lambda_src: 0.0
11-16 22:24:36 lambda_src_decay_patience: 2
11-16 22:24:36 lambda_src_decay_factor: 0.5
11-16 22:24:36 lambda_src_min: 0.0
11-16 22:24:36 lambda_src_warmup: 0
11-16 22:24:36 improvement_metric: common
11-16 22:24:36 auto_select: True
11-16 22:24:36 llm_compare: True
11-16 22:24:36 llm_backend: openai
11-16 22:24:36 llm_model: None
11-16 22:24:36 llm_context: 
11-16 22:24:36 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 22:24:36 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention suitable to capture local and some longer-range dependencies without excessive compute. Label inconsistency suggests avoiding openmax or unknown heads to reduce tuning complexity. Dropout at 0.3 balances overfitting risk due to label noise. Batch size 64 and learning rate 0.001 align with hints and stable training. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32 steps) and 7 channels, making a 1-D CNN with self-attention suitable to capture local and some longer-range dependencies without excessive compute. Label inconsistency suggests avoiding openmax or unknown heads to reduce tuning complexity. Dropout at 0.3 balances overfitting risk due to label noise. Batch size 64 and learning rate 0.001 align with hints and stable training."\n}'}
11-16 22:24:36 llm_cfg_stamp: 20251116_222040
11-16 22:24:36 tag: sngp_wrn_sa_20251116_222040
11-16 22:24:36 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 22:24:36 dataset_cycle_stats: {'source_train_cycles': 825, 'source_val_cycles': 320, 'source_val_has_holdout': True, 'target_train_cycles': 205, 'target_val_cycles': 60, 'target_val_has_holdout': True, 'source_train_sequences': 165, 'source_val_sequences': 64, 'target_train_sequences': 41, 'target_val_sequences': 12, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 5, 'total_cycles': 1021}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 5, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 5, 'total_cycles': 852}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 5, 'total_cycles': 1528}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 5, 'total_cycles': 1415}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 5, 'total_cycles': 1493}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 5, 'total_cycles': 1273}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 5, 'total_cycles': 1222}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 5, 'total_cycles': 704}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 5, 'total_cycles': 710}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 5, 'total_cycles': 712}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 5, 'total_cycles': 168}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 5, 'total_cycles': 1309}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 5, 'total_cycles': 1121}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 5, 'total_cycles': 1122}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 5, 'total_cycles': 1079}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 5, 'total_cycles': 1080}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 5, 'total_cycles': 358}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 5, 'total_cycles': 1023}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 5, 'total_cycles': 628}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 5, 'total_cycles': 1946}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 5, 'total_cycles': 2145}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 5, 'total_cycles': 2146}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 5, 'total_cycles': 932}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 5, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 5, 'total_cycles': 621}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 5, 'total_cycles': 940}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 5, 'total_cycles': 942}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 5, 'total_cycles': 979}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 5, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 5, 'total_cycles': 618}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 5, 'total_cycles': 946}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 5, 'total_cycles': 196}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 5, 'total_cycles': 195}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 5, 'total_cycles': 188}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 5, 'total_cycles': 257}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 5, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 5, 'total_cycles': 620}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 5, 'total_cycles': 635}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 5, 'total_cycles': 602}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 5, 'total_cycles': 1557}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 5, 'total_cycles': 1608}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 5, 'total_cycles': 532}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 5, 'total_cycles': 788}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 5, 'total_cycles': 1109}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 5, 'total_cycles': 1147}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 5, 'total_cycles': 716}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 5, 'total_cycles': 1318}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 5, 'total_cycles': 1221}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 5, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 5, 'total_cycles': 1766}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 5, 'total_cycles': 180}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 5, 'total_cycles': 516}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 5, 'total_cycles': 1123}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 5, 'total_cycles': 1425}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 5, 'total_cycles': 1424}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 5, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 5, 'total_cycles': 1024}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 5, 'total_cycles': 371}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 5, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 5, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 5, 'total_cycles': 2148}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 5, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 5, 'total_cycles': 171}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 5, 'total_cycles': 789}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 5, 'total_cycles': 944}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 5, 'total_cycles': 619}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 5, 'total_cycles': 939}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 5, 'total_cycles': 1045}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 5, 'total_cycles': 169}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 5, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 5, 'total_cycles': 2325}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 5, 'total_cycles': 2324}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 5, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 5, 'total_cycles': 600}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 5, 'total_cycles': 606}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 5, 'total_cycles': 1004}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 5, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 5, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 5, 'total_cycles': 251}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 5, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 5, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 5, 'total_cycles': 1495}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 5, 'total_cycles': 1494}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 5, 'total_cycles': 533}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 5, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 5, 'total_cycles': 788}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 5, 'total_cycles': 216}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 5, 'total_cycles': 846}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 5, 'total_cycles': 855}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 5, 'total_cycles': 687}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 5, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 5, 'total_cycles': 2028}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 5, 'total_cycles': 220}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 5, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 5, 'total_cycles': 421}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 5, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 5, 'total_cycles': 820}]}}, 'feature_columns': ('cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration', 'capacity_retention', 'energy_retention', 'delta_capacity_discharge', 'delta_energy_discharge', 'delta_cycle_duration', 'rolling_capacity_mean', 'rolling_capacity_std', 'rolling_energy_mean', 'rolling_energy_std', 'rolling_duration_mean', 'duration_ratio', 'coulombic_efficiency', 'energy_efficiency', 'time_per_capacity')}
11-16 22:24:36 input_size: 32
11-16 22:24:36 reinit_head: False
11-16 22:24:36 using 1 cpu
11-16 22:24:36 Reducing learning rate to 5e-05 for 41 target samples
11-16 22:24:36 Freezing early layers of backbone for 41 target samples
11-16 22:24:36 Exception in callback functools.partial(<bound method OutStream._flush of <spyder_kernels.console.outstream.TTYOutStream object at 0x172cdca90>>)
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/ioloop.py", line 750, in _run_callback
    ret = callback()
          ^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed
11-16 22:58:56 data_name: Battery_inconsistent
11-16 22:58:56 data_dir: ./my_datasets/Battery
11-16 22:58:56 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
11-16 22:58:56 normlizetype: mean-std
11-16 22:58:56 method: sngp
11-16 22:58:56 gp_hidden_dim: 2048
11-16 22:58:56 spectral_norm_bound: 0.95
11-16 22:58:56 n_power_iterations: 1
11-16 22:58:56 nesterov: True
11-16 22:58:56 print_freq: 10
11-16 22:58:56 layers: 16
11-16 22:58:56 widen_factor: 1
11-16 22:58:56 droprate: 0.3
11-16 22:58:56 cuda_device: 0
11-16 22:58:56 checkpoint_dir: ./checkpoint
11-16 22:58:56 pretrained: True
11-16 22:58:56 batch_size: 64
11-16 22:58:56 num_workers: 0
11-16 22:58:56 bottleneck: True
11-16 22:58:56 bottleneck_num: 128
11-16 22:58:56 last_batch: False
11-16 22:58:56 hidden_size: 1024
11-16 22:58:56 trade_off_adversarial: Step
11-16 22:58:56 lam_adversarial: 1
11-16 22:58:56 opt: adam
11-16 22:58:56 lr: 5e-05
11-16 22:58:56 momentum: 0.9
11-16 22:58:56 weight_decay: 1e-05
11-16 22:58:56 lr_scheduler: step
11-16 22:58:56 gamma: 0.1
11-16 22:58:56 steps: 150, 250
11-16 22:58:56 middle_epoch: 15
11-16 22:58:56 max_epoch: 62
11-16 22:58:56 print_step: 25
11-16 22:58:56 inconsistent: UAN
11-16 22:58:56 model_name: WideResNet_sa
11-16 22:58:56 th: 0.5
11-16 22:58:56 input_channels: 21
11-16 22:58:56 classification_label: eol_class
11-16 22:58:56 sequence_length: 32
11-16 22:58:56 cycles_per_file: 30
11-16 22:58:56 sample_random_state: 42
11-16 22:58:56 transfer_task: [[0], [1]]
11-16 22:58:56 source_cathode: ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811']
11-16 22:58:56 target_cathode: ['5Vspinel']
11-16 22:58:56 num_classes: 5
11-16 22:58:56 domain_temperature: 1.0
11-16 22:58:56 class_temperature: 10.0
11-16 22:58:56 lambda_src: 0.0
11-16 22:58:56 lambda_src_decay_patience: 2
11-16 22:58:56 lambda_src_decay_factor: 0.5
11-16 22:58:56 lambda_src_min: 0.0
11-16 22:58:56 lambda_src_warmup: 0
11-16 22:58:56 improvement_metric: common
11-16 22:58:56 auto_select: True
11-16 22:58:56 llm_compare: True
11-16 22:58:56 llm_backend: openai
11-16 22:58:56 llm_model: None
11-16 22:58:56 llm_context: 
11-16 22:58:56 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: (all available); target cathodes: (none specified).\nLabel column 'eol_class' with ~None classes; sequence length 32; 7 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.001, 'dropout_hint': 0.3, 'num_classes_hint': None, 'splits': {}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': [], 'target_cathodes': [], 'label_column': 'eol_class'}}
11-16 22:58:56 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.3, 'learning_rate': 0.001, 'batch_size': 64, 'lambda_src': 0.0, 'rationale': 'The dataset has short sequences (32) and 7 channels, making a lightweight CNN with self-attention ideal to capture local features and some longer-range dependencies. The label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and tuning overhead. Dropout at 0.3 balances overfitting risk due to label noise. Batch size 64 fits memory and training stability. This config should outperform the baseline deterministic CNN by leveraging attention without excessive capacity or open-set complexity. Label inconsistency flagged → calibrated heads (SNGP/OpenMax) stay enabled for open-set robustness. Enabled SNGP to stabilise open-set transfer risk detected in metadata.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.3,\n  "learning_rate": 0.001,\n  "batch_size": 64,\n  "lambda_src": 0.0,\n  "rationale": "The dataset has short sequences (32) and 7 channels, making a lightweight CNN with self-attention ideal to capture local features and some longer-range dependencies. The label inconsistency suggests avoiding openmax or unknown heads to reduce complexity and tuning overhead. Dropout at 0.3 balances overfitting risk due to label noise. Batch size 64 fits memory and training stability. This config should outperform the baseline deterministic CNN by leveraging attention without excessive capacity or open-set complexity."\n}'}
11-16 22:58:56 llm_cfg_stamp: 20251116_225503
11-16 22:58:56 tag: sngp_wrn_sa_20251116_225503
11-16 22:58:56 pretrained_model_path: ./checkpoint/transfer_WideResNet_sa_nmc_to_spinel5v_1116/best_model.pth
11-16 22:58:56 dataset_cycle_stats: {'source_train_cycles': 4950, 'source_val_cycles': 1920, 'source_val_has_holdout': True, 'target_train_cycles': 1230, 'target_val_cycles': 360, 'target_val_has_holdout': True, 'source_train_sequences': 165, 'source_val_sequences': 64, 'target_train_sequences': 41, 'target_val_sequences': 12, 'source_train_cells': 31, 'source_val_cells': 11, 'target_train_cells': 5, 'target_val_cells': 2, 'cycles_per_cell_per_cathode': {'source_train': {'HE5050': [{'filename': 'batch_B12A_cell_2.h5', 'cycles': 30, 'total_cycles': 1121}, {'filename': 'batch_B14D_cell_8.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B4A_cell_2.h5', 'cycles': 30, 'total_cycles': 516}, {'filename': 'batch_B4A_cell_3.h5', 'cycles': 30, 'total_cycles': 1021}, {'filename': 'batch_B4A_cell_5.h5', 'cycles': 30, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_7.h5', 'cycles': 30, 'total_cycles': 1020}, {'filename': 'batch_B4A_cell_8.h5', 'cycles': 30, 'total_cycles': 852}, {'filename': 'batch_B4B_cell_2.h5', 'cycles': 30, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_3.h5', 'cycles': 30, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_4.h5', 'cycles': 30, 'total_cycles': 180}, {'filename': 'batch_B4B_cell_8.h5', 'cycles': 30, 'total_cycles': 180}, {'filename': 'batch_B9A_cell_19.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_2.h5', 'cycles': 30, 'total_cycles': 1528}, {'filename': 'batch_B9A_cell_21.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_22.h5', 'cycles': 30, 'total_cycles': 216}, {'filename': 'batch_B9A_cell_3.h5', 'cycles': 30, 'total_cycles': 1415}, {'filename': 'batch_B9A_cell_4.h5', 'cycles': 30, 'total_cycles': 1493}, {'filename': 'batch_B9A_cell_5.h5', 'cycles': 30, 'total_cycles': 1273}, {'filename': 'batch_B9A_cell_8.h5', 'cycles': 30, 'total_cycles': 1222}, {'filename': 'batch_B9B_cell_2.h5', 'cycles': 30, 'total_cycles': 704}, {'filename': 'batch_B9B_cell_3.h5', 'cycles': 30, 'total_cycles': 710}, {'filename': 'batch_B9B_cell_4.h5', 'cycles': 30, 'total_cycles': 712}, {'filename': 'batch_B9B_cell_5.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_7.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9B_cell_8.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_5.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9C_cell_7.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B1A_cell_4.h5', 'cycles': 30, 'total_cycles': 168}, {'filename': 'batch_B14D_cell_7.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_3.h5', 'cycles': 30, 'total_cycles': 1309}, {'filename': 'batch_B14D_cell_5.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_4.h5', 'cycles': 30, 'total_cycles': 1121}, {'filename': 'batch_B12A_cell_5.h5', 'cycles': 30, 'total_cycles': 1122}, {'filename': 'batch_B12A_cell_7.h5', 'cycles': 30, 'total_cycles': 1079}, {'filename': 'batch_B12A_cell_8.h5', 'cycles': 30, 'total_cycles': 1080}, {'filename': 'batch_B12B_cell_3.h5', 'cycles': 30, 'total_cycles': 358}, {'filename': 'batch_B14A_cell_10.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_11.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_12.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_10.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_11.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_12.h5', 'cycles': 30, 'total_cycles': 1023}, {'filename': 'batch_B14B_cell_2.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_3.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_4.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_5.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_7.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_8.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14C_cell_2.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_3.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_4.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_5.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_8.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_2.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_3.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14D_cell_4.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B9C_cell_8.h5', 'cycles': 30, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B21A_cell_10.h5', 'cycles': 30, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_15.h5', 'cycles': 30, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_16.h5', 'cycles': 30, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_2.h5', 'cycles': 30, 'total_cycles': 628}, {'filename': 'batch_B21A_cell_3.h5', 'cycles': 30, 'total_cycles': 628}, {'filename': 'batch_B27B_cell_4.h5', 'cycles': 30, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_7.h5', 'cycles': 30, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_8.h5', 'cycles': 30, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_28.h5', 'cycles': 30, 'total_cycles': 1946}, {'filename': 'batch_B6A_cell_32.h5', 'cycles': 30, 'total_cycles': 2145}, {'filename': 'batch_B6A_cell_43.h5', 'cycles': 30, 'total_cycles': 2146}, {'filename': 'batch_B6D_cell_3.h5', 'cycles': 30, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B10A_cell_3.h5', 'cycles': 30, 'total_cycles': 932}, {'filename': 'batch_B35A_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35G_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_4.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_3.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B30B_cell_2.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_4.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_3.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B30A_cell_2.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_8.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_5.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B35H_cell_2.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B7A_cell_17.h5', 'cycles': 30, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_19.h5', 'cycles': 30, 'total_cycles': 790}, {'filename': 'batch_B7A_cell_2.h5', 'cycles': 30, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_21.h5', 'cycles': 30, 'total_cycles': 621}, {'filename': 'batch_B7A_cell_22.h5', 'cycles': 30, 'total_cycles': 618}, {'filename': 'batch_B7A_cell_23.h5', 'cycles': 30, 'total_cycles': 620}, {'filename': 'batch_B7A_cell_3.h5', 'cycles': 30, 'total_cycles': 940}, {'filename': 'batch_B7A_cell_4.h5', 'cycles': 30, 'total_cycles': 939}, {'filename': 'batch_B7A_cell_5.h5', 'cycles': 30, 'total_cycles': 942}, {'filename': 'batch_B7A_cell_7.h5', 'cycles': 30, 'total_cycles': 979}, {'filename': 'batch_B7A_cell_8.h5', 'cycles': 30, 'total_cycles': 939}, {'filename': 'batch_B7B_cell_2.h5', 'cycles': 30, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_3.h5', 'cycles': 30, 'total_cycles': 787}, {'filename': 'batch_B7B_cell_4.h5', 'cycles': 30, 'total_cycles': 789}, {'filename': 'batch_B7B_cell_5.h5', 'cycles': 30, 'total_cycles': 620}, {'filename': 'batch_B7B_cell_7.h5', 'cycles': 30, 'total_cycles': 618}, {'filename': 'batch_B28B_cell_4.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_2.h5', 'cycles': 30, 'total_cycles': 2325}, {'filename': 'batch_B10A_cell_4.h5', 'cycles': 30, 'total_cycles': 946}, {'filename': 'batch_B16A_cell_8.h5', 'cycles': 30, 'total_cycles': 195}, {'filename': 'batch_B17A_cell_8.h5', 'cycles': 30, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_7.h5', 'cycles': 30, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_5.h5', 'cycles': 30, 'total_cycles': 251}, {'filename': 'batch_B17A_cell_4.h5', 'cycles': 30, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_3.h5', 'cycles': 30, 'total_cycles': 267}, {'filename': 'batch_B17A_cell_2.h5', 'cycles': 30, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_7.h5', 'cycles': 30, 'total_cycles': 195}, {'filename': 'batch_B28B_cell_16.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B16A_cell_4.h5', 'cycles': 30, 'total_cycles': 196}, {'filename': 'batch_B16A_cell_3.h5', 'cycles': 30, 'total_cycles': 195}, {'filename': 'batch_B16A_cell_2.h5', 'cycles': 30, 'total_cycles': 188}, {'filename': 'batch_B16A_cell_12.h5', 'cycles': 30, 'total_cycles': 257}, {'filename': 'batch_B16A_cell_11.h5', 'cycles': 30, 'total_cycles': 251}, {'filename': 'batch_B16A_cell_10.h5', 'cycles': 30, 'total_cycles': 257}, {'filename': 'batch_B28A_cell_34.h5', 'cycles': 30, 'total_cycles': 606}, {'filename': 'batch_B28A_cell_35.h5', 'cycles': 30, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_37.h5', 'cycles': 30, 'total_cycles': 603}, {'filename': 'batch_B28A_cell_38.h5', 'cycles': 30, 'total_cycles': 620}, {'filename': 'batch_B28A_cell_40.h5', 'cycles': 30, 'total_cycles': 635}, {'filename': 'batch_B28A_cell_41.h5', 'cycles': 30, 'total_cycles': 602}, {'filename': 'batch_B28A_cell_43.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_44.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_46.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_47.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_48.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_49.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28B_cell_10.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_11.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_12.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_14.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_15.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B7B_cell_8.h5', 'cycles': 30, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_2.h5', 'cycles': 30, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_3.h5', 'cycles': 30, 'total_cycles': 198}, {'filename': 'batch_B37B_cell_4.h5', 'cycles': 30, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_2.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_3.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38A_cell_4.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_2.h5', 'cycles': 30, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_4.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38B_cell_5.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_2.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_3.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38C_cell_4.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_2.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_3.h5', 'cycles': 30, 'total_cycles': 1557}, {'filename': 'batch_B38D_cell_4.h5', 'cycles': 30, 'total_cycles': 1608}], 'NMC811': [{'filename': 'batch_B34A_cell_2.h5', 'cycles': 30, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_3.h5', 'cycles': 30, 'total_cycles': 532}, {'filename': 'batch_B34A_cell_4.h5', 'cycles': 30, 'total_cycles': 532}, {'filename': 'batch_B34B_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_3.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34B_cell_4.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_3.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_4.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_2.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_3.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34D_cell_4.h5', 'cycles': 30, 'total_cycles': 788}]}, 'source_val': {'HE5050': [{'filename': 'batch_B12A_cell_1.h5', 'cycles': 30, 'total_cycles': 1109}, {'filename': 'batch_B4A_cell_1.h5', 'cycles': 30, 'total_cycles': 1147}, {'filename': 'batch_B9B_cell_1.h5', 'cycles': 30, 'total_cycles': 716}, {'filename': 'batch_B9A_cell_9.h5', 'cycles': 30, 'total_cycles': 1318}, {'filename': 'batch_B9A_cell_6.h5', 'cycles': 30, 'total_cycles': 1221}, {'filename': 'batch_B9A_cell_20.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_18.h5', 'cycles': 30, 'total_cycles': 235}, {'filename': 'batch_B9A_cell_1.h5', 'cycles': 30, 'total_cycles': 1766}, {'filename': 'batch_B4B_cell_6.h5', 'cycles': 30, 'total_cycles': 180}, {'filename': 'batch_B4A_cell_6.h5', 'cycles': 30, 'total_cycles': 516}, {'filename': 'batch_B14D_cell_6.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B12A_cell_6.h5', 'cycles': 30, 'total_cycles': 1123}, {'filename': 'batch_B14D_cell_1.h5', 'cycles': 30, 'total_cycles': 1425}, {'filename': 'batch_B14C_cell_6.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14C_cell_1.h5', 'cycles': 30, 'total_cycles': 1424}, {'filename': 'batch_B14B_cell_9.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_6.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14B_cell_1.h5', 'cycles': 30, 'total_cycles': 1022}, {'filename': 'batch_B14A_cell_13.h5', 'cycles': 30, 'total_cycles': 1024}, {'filename': 'batch_B12B_cell_1.h5', 'cycles': 30, 'total_cycles': 371}, {'filename': 'batch_B9B_cell_6.h5', 'cycles': 30, 'total_cycles': 235}], 'NMC111': [{'filename': 'batch_B27B_cell_1.h5', 'cycles': 30, 'total_cycles': 1556}, {'filename': 'batch_B27B_cell_6.h5', 'cycles': 30, 'total_cycles': 1556}, {'filename': 'batch_B6A_cell_42.h5', 'cycles': 30, 'total_cycles': 2148}, {'filename': 'batch_B6D_cell_6.h5', 'cycles': 30, 'total_cycles': 219}], 'NMC532': [{'filename': 'batch_B16A_cell_1.h5', 'cycles': 30, 'total_cycles': 171}, {'filename': 'batch_B35A_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B7B_cell_1.h5', 'cycles': 30, 'total_cycles': 789}, {'filename': 'batch_B7A_cell_6.h5', 'cycles': 30, 'total_cycles': 944}, {'filename': 'batch_B7A_cell_24.h5', 'cycles': 30, 'total_cycles': 619}, {'filename': 'batch_B7A_cell_20.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_18.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B7A_cell_1.h5', 'cycles': 30, 'total_cycles': 939}, {'filename': 'batch_B35H_cell_1.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B35G_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35F_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35E_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35D_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35C_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B35B_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B30B_cell_1.h5', 'cycles': 30, 'total_cycles': 1045}, {'filename': 'batch_B16A_cell_6.h5', 'cycles': 30, 'total_cycles': 169}, {'filename': 'batch_B30A_cell_1.h5', 'cycles': 30, 'total_cycles': 1044}, {'filename': 'batch_B28B_cell_9.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_6.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28B_cell_13.h5', 'cycles': 30, 'total_cycles': 2325}, {'filename': 'batch_B28B_cell_1.h5', 'cycles': 30, 'total_cycles': 2324}, {'filename': 'batch_B28A_cell_45.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_42.h5', 'cycles': 30, 'total_cycles': 276}, {'filename': 'batch_B28A_cell_39.h5', 'cycles': 30, 'total_cycles': 600}, {'filename': 'batch_B28A_cell_36.h5', 'cycles': 30, 'total_cycles': 606}, {'filename': 'batch_B20B_cell_6.h5', 'cycles': 30, 'total_cycles': 1004}, {'filename': 'batch_B17A_cell_6.h5', 'cycles': 30, 'total_cycles': 250}, {'filename': 'batch_B17A_cell_1.h5', 'cycles': 30, 'total_cycles': 267}, {'filename': 'batch_B16A_cell_9.h5', 'cycles': 30, 'total_cycles': 251}, {'filename': 'batch_B7B_cell_6.h5', 'cycles': 30, 'total_cycles': 621}], 'NMC622': [{'filename': 'batch_B37B_cell_1.h5', 'cycles': 30, 'total_cycles': 198}, {'filename': 'batch_B38A_cell_1.h5', 'cycles': 30, 'total_cycles': 1495}, {'filename': 'batch_B38B_cell_1.h5', 'cycles': 30, 'total_cycles': 1495}, {'filename': 'batch_B38C_cell_1.h5', 'cycles': 30, 'total_cycles': 1494}, {'filename': 'batch_B38D_cell_1.h5', 'cycles': 30, 'total_cycles': 1494}], 'NMC811': [{'filename': 'batch_B34A_cell_1.h5', 'cycles': 30, 'total_cycles': 533}, {'filename': 'batch_B34B_cell_1.h5', 'cycles': 30, 'total_cycles': 788}, {'filename': 'batch_B34C_cell_1.h5', 'cycles': 30, 'total_cycles': 788}]}, 'target_train': {'5Vspinel': [{'filename': 'batch_B11B_cell_4.h5', 'cycles': 30, 'total_cycles': 216}, {'filename': 'batch_B26U_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26V_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26V_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26W_cell_1.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26W_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26X_cell_1.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26X_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_1.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26Z_cell_3.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_1.h5', 'cycles': 30, 'total_cycles': 846}, {'filename': 'batch_B5A_cell_5.h5', 'cycles': 30, 'total_cycles': 855}, {'filename': 'batch_B26V_cell_1.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_1.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26T_cell_4.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26AA_cell_4.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26K_cell_1.h5', 'cycles': 30, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_1.h5', 'cycles': 30, 'total_cycles': 2028}, {'filename': 'batch_B26N_cell_1.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_1.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_4.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26O_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_3.h5', 'cycles': 30, 'total_cycles': 421}, {'filename': 'batch_B26P_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26Q_cell_3.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26Q_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_1.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26R_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_3.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_4.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26S_cell_5.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_7.h5', 'cycles': 30, 'total_cycles': 687}]}, 'target_val': {'5Vspinel': [{'filename': 'batch_B26K_cell_2.h5', 'cycles': 30, 'total_cycles': 221}, {'filename': 'batch_B26L_cell_2.h5', 'cycles': 30, 'total_cycles': 2028}, {'filename': 'batch_B26M_cell_2.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26P_cell_2.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26P_cell_6.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B26R_cell_2.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26T_cell_2.h5', 'cycles': 30, 'total_cycles': 220}, {'filename': 'batch_B26V_cell_2.h5', 'cycles': 30, 'total_cycles': 421}, {'filename': 'batch_B26X_cell_2.h5', 'cycles': 30, 'total_cycles': 420}, {'filename': 'batch_B26Y_cell_2.h5', 'cycles': 30, 'total_cycles': 421}, {'filename': 'batch_B26Z_cell_2.h5', 'cycles': 30, 'total_cycles': 219}, {'filename': 'batch_B5A_cell_2.h5', 'cycles': 30, 'total_cycles': 820}]}}, 'feature_columns': ('cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration', 'capacity_retention', 'energy_retention', 'delta_capacity_discharge', 'delta_energy_discharge', 'delta_cycle_duration', 'rolling_capacity_mean', 'rolling_capacity_std', 'rolling_energy_mean', 'rolling_energy_std', 'rolling_duration_mean', 'duration_ratio', 'coulombic_efficiency', 'energy_efficiency', 'time_per_capacity')}
11-16 22:58:56 input_size: 32
11-16 22:58:56 reinit_head: False
11-16 22:58:56 using 1 cpu
11-16 22:58:56 Reducing learning rate to 5e-05 for 41 target samples
11-16 22:58:56 Freezing early layers of backbone for 41 target samples
11-16 22:58:56 Exception in callback functools.partial(<bound method OutStream._flush of <spyder_kernels.console.outstream.TTYOutStream object at 0x172cdca90>>)
Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 100, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/tornado/ioloop.py", line 750, in _run_callback
    ret = callback()
          ^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/ipykernel/iostream.py", line 649, in _flush
    self.session.send(
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 852, in send
    to_send = self.serialize(msg, ident)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 721, in serialize
    content = self.pack(content)
              ^^^^^^^^^^^^^^^^^^
  File "/Users/moondiab/opt/anaconda3/envs/venv/lib/python3.11/site-packages/jupyter_client/session.py", line 108, in json_packer
    ).encode("utf8", errors="surrogateescape")
      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
UnicodeEncodeError: 'utf-8' codec can't encode characters in position 28-29: surrogates not allowed
