12-12 14:13:22 data_name: Battery_inconsistent
12-12 14:13:22 data_dir: ./my_datasets/Battery
12-12 14:13:22 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
12-12 14:13:22 normlizetype: mean-std
12-12 14:13:22 method: sngp
12-12 14:13:22 gp_hidden_dim: 2048
12-12 14:13:22 spectral_norm_bound: 0.95
12-12 14:13:22 n_power_iterations: 1
12-12 14:13:22 nesterov: True
12-12 14:13:22 print_freq: 10
12-12 14:13:22 layers: 16
12-12 14:13:22 widen_factor: 1
12-12 14:13:22 droprate: 0.35
12-12 14:13:22 cuda_device: 0
12-12 14:13:22 checkpoint_dir: ./checkpoint
12-12 14:13:22 pretrained: False
12-12 14:13:22 batch_size: 8
12-12 14:13:22 warmup_epochs: 3
12-12 14:13:22 num_workers: 0
12-12 14:13:22 bottleneck: True
12-12 14:13:22 bottleneck_num: 256
12-12 14:13:22 last_batch: False
12-12 14:13:22 hidden_size: 1024
12-12 14:13:22 trade_off_adversarial: Step
12-12 14:13:22 lam_adversarial: 1
12-12 14:13:22 opt: adam
12-12 14:13:22 lr: 0.0005
12-12 14:13:22 momentum: 0.9
12-12 14:13:22 weight_decay: 1e-05
12-12 14:13:22 lr_scheduler: step
12-12 14:13:22 gamma: 0.1
12-12 14:13:22 steps: 150, 250
12-12 14:13:22 middle_epoch: 15
12-12 14:13:22 max_epoch: 50
12-12 14:13:22 print_step: 25
12-12 14:13:22 inconsistent: UAN
12-12 14:13:22 model_name: cnn_features_1d_sa
12-12 14:13:22 th: 0.5
12-12 14:13:22 input_channels: 7
12-12 14:13:22 classification_label: eol_class
12-12 14:13:22 sequence_length: 32
12-12 14:13:22 cycles_per_file: 15
12-12 14:13:22 source_cycles_per_file: None
12-12 14:13:22 target_cycles_per_file: None
12-12 14:13:22 cycle_ablation: False
12-12 14:13:22 cycle_ablation_start: 5
12-12 14:13:22 cycle_ablation_step: 10
12-12 14:13:22 cycle_ablation_max: None
12-12 14:13:22 literature_context_file: ./references/joule_s2542-4351-22-00409-3.md
12-12 14:13:22 sample_random_state: 42
12-12 14:13:22 transfer_task: [[[0], [1]], [[0], [2]], [[0], [3]], [[1], [0]], [[1], [2]], [[1], [3]], [[2], [0]], [[2], [1]], [[2], [3]], [[3], [0]], [[3], [1]], [[3], [2]]]
12-12 14:13:22 source_cathode: ['5Vspinel']
12-12 14:13:22 target_cathode: []
12-12 14:13:22 num_classes: None
12-12 14:13:22 domain_temperature: 1.0
12-12 14:13:22 class_temperature: 10.0
12-12 14:13:22 lambda_src: 0.6
12-12 14:13:22 lambda_src_decay_patience: 5
12-12 14:13:22 lambda_src_decay_factor: 0.5
12-12 14:13:22 lambda_src_min: 0.0
12-12 14:13:22 lambda_src_warmup: 0
12-12 14:13:22 improvement_metric: accuracy
12-12 14:13:22 skip_retry: False
12-12 14:13:22 auto_select: True
12-12 14:13:22 llm_compare: True
12-12 14:13:22 llm_backend: openai
12-12 14:13:22 llm_model: None
12-12 14:13:22 llm_context: 
12-12 14:13:22 llm_ablation: False
12-12 14:13:22 llm_per_transfer: True
12-12 14:13:22 ablation_cycle_limits: 
12-12 14:13:22 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: 5Vspinel; target cathodes: HE5050, NMC111, NMC532, NMC622, NMC811.\nLabel column 'eol_class' with ~None classes; sequence length 32; 21 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.\nLiterature cues (Joule S2542-4351(22)00409-3, chemistry-sensitive ablations):\nJoule 2022 (S2542-4351(22)00409-3) key cues for chemistry-aware ablation:\n- Early-cycle capacity fade slopes and coulombic-efficiency stabilization highlight whether aging is lithium-inventory loss (graphite/anode-electrolyte limited) versus cathode structural decay (e.g., Ni-rich NMC cathodes with electrolyte oxidation risk).\n- High initial impedance growth, thick SEI signatures, or electrolyte oxidation markers flag chemistries that benefit from uncertainty-aware heads (SNGP/OpenMax) to avoid overconfident extrapolation on outlier cycles.\n- LFP/graphite pairs tend to show flatter voltage plateaus and slower early fade; Ni-rich NMC chemistries degrade faster under aggressive cycling and need stronger regularization or shorter cycle horizons in ablations.\n- Transfer between mismatched chemistries (e.g., NMC → LFP) should down-weight source loss and favor architectures that adapt quickly with self-attention or wider bottlenecks; closely matched chemistries can rely more on convolutional baselines.\nsource_train: class counts 0:19, 1:18, 2:2, 3:1, 4:1 (example label 1).\nsource_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.016899999231100082, 0.0012000000569969416, -0.030400000512599945, -0.03880000114440918, -0.04360000044107437, -0.05829999968409538, -0.0729999989271164, -0.074…\nsource_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_train: class counts 0:22, 1:22, 2:38, 3:34, 4:39 (example label 1).\ntarget_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.3743000030517578, 0.37630000710487366, 0.3709999918937683, 0.3490999937057495, 0.34459999203681946, 0.34619998931884766, 0.32109999656677246, 0.3179000020027160…\ntarget_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]\nsource_val: class counts 0:5, 1:5, 2:1, 4:1 (example label 0).\nsource_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759…\nsource_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_val: class counts 0:9, 1:10, 2:19, 3:17, 4:19 (example label 3).\ntarget_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.174100041389…\ntarget_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.0005, 'dropout_hint': 0.35, 'num_classes_hint': None, 'splits': {'source_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.016899999231100082, 0.0012000000569969416, -0.030400000512599945, -0.03880000114440918, -0.04360000044107437, -0.05829999968409538, -0.0729999989271164, -0.07419999688863754, -0.07940000295639038, -0.10239999741315842, -0.11169999837875366], [-1.13100004196167, -0.17839999496936798, -0.15639999508857727, -0.18359999358654022, -0.19140000641345978, -0.195700004696846, -0.20919999480247498, -0.22220000624656677, -0.22349999845027924, -0.22930000722408295, -0.2498999983072281, -0.25760000944137573]]}, 'batch_channel_mean': [0.8607000112533569, -0.19619999825954437, -0.3012000024318695, -0.15970000624656677, -0.301800012588501, 0.9627000093460083, -0.1062999963760376, 0.14169999957084656], 'batch_channel_std': [1.059499979019165, 0.24040000140666962, 0.17249999940395355, 0.25209999084472656, 0.17270000278949738, 1.1347999572753906, 0.824999988079071, 0.6575999855995178], 'class_distribution': {'0': 19, '1': 18, '2': 2, '3': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1401425697203385], 'feature_global_mean': -0.016921664518018544, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.3743000030517578, 0.37630000710487366, 0.3709999918937683, 0.3490999937057495, 0.34459999203681946, 0.34619998931884766, 0.32109999656677246, 0.31790000200271606, 0.29190000891685486, 0.24529999494552612, 0.24169999361038208], [-1.13100004196167, 0.4562999904155731, 0.46230000257492065, 0.45500001311302185, 0.4316999912261963, 0.4268999993801117, 0.42480000853538513, 0.397599995136261, 0.39410001039505005, 0.36640000343322754, 0.31610000133514404, 0.3122999966144562]]}, 'batch_channel_mean': [0.8607000112533569, -0.04560000076889992, -0.01269999984651804, -0.06199999898672104, -0.009600000455975533, 0.1704999953508377, -0.36579999327659607, -0.0020000000949949026], 'batch_channel_std': [1.059499979019165, 0.5946999788284302, 0.5917999744415283, 0.5709999799728394, 0.5871999859809875, 0.9681000113487244, 0.6819999814033508, 0.7301999926567078], 'class_distribution': {'0': 22, '1': 22, '2': 38, '3': 34, '4': 39}, 'feature_range': [-9.981793547102113, 31.866555053073082], 'feature_global_mean': 0.043367023845691036, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}, 'source_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759999334812164, -0.2379000037908554, -0.2531999945640564, -0.2678999900817871], [-1.13100004196167, -0.19740000367164612, -0.21279999613761902, -0.25780001282691956, -0.28760001063346863, -0.3043000102043152, -0.32760000228881836, -0.3458000123500824, -0.3540000021457672, -0.3650999963283539, -0.37959998846054077, -0.3926999866962433]]}, 'batch_channel_mean': [0.8607000112533569, -0.21899999678134918, -0.3481999933719635, -0.1915999948978424, -0.34689998626708984, 1.118899941444397, -0.11599999666213989, 0.016499999910593033], 'batch_channel_std': [1.059499979019165, 0.21160000562667847, 0.17630000412464142, 0.2303999960422516, 0.17829999327659607, 0.9266999959945679, 0.8331000208854675, 0.7063000202178955], 'class_distribution': {'0': 5, '1': 5, '2': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1560300164083985], 'feature_global_mean': -0.010901597356338598, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 3, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653], [-1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167]]}, 'batch_channel_mean': [0.8607000112533569, 0.27559998631477356, 0.2630000114440918, 0.1655000001192093, 0.2653000056743622, 0.005200000014156103, -0.3278999924659729, -0.6205999851226807], 'batch_channel_std': [1.059499979019165, 0.4851999878883362, 0.47620001435279846, 0.46309998631477356, 0.47749999165534973, 0.9384999871253967, 0.8022000193595886, 0.9699000120162964], 'class_distribution': {'0': 9, '1': 10, '2': 19, '3': 17, '4': 19}, 'feature_range': [-3.426709644883315, 32.206823553376644], 'feature_global_mean': 0.014365731412246173, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': ['5Vspinel'], 'target_cathodes': ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811'], 'label_column': 'eol_class', 'split_used': 'source_train', 'batch_size_seen': 8, 'channels': 21, 'seq_len': 32}}
12-12 14:13:22 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 256, 'dropout': 0.35, 'learning_rate': 0.0005, 'batch_size': 8, 'lambda_src': 0.6, 'warmup_epochs': 10, 'rationale': 'The dataset has 21 channels and short sequence length (32), favoring CNN with self-attention to capture local and some global dependencies. The domain shift from 5Vspinel to HE5050 and label inconsistency suggest using self-attention for adaptability without the complexity of openmax or SNGP. Moderate bottleneck and dropout balance capacity and regularization. Batch size 8 matches seen data, and warmup helps stabilize transfer learning. Target cathode: HE5050 (high-energy experimental blend). Source cathodes: 5Vspinel (high-voltage spinel (manganese rich)). Source/target chemistries differ → expect domain shift. Evaluated 21 channels × 32-step windows and matched them with cnn_1d_sa capacity. Target fine-tune spans ≈155 cycles versus 41 source cycles, guiding lr=5.00e-04 and dropout=0.35.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 256,\n  "dropout": 0.35,\n  "learning_rate": 0.0005,\n  "batch_size": 8,\n  "lambda_src": 1.0,\n  "warmup_epochs": 10,\n  "rationale": "The dataset has 21 channels and short sequence length (32), favoring CNN with self-attention to capture local and some global dependencies. The domain shift from 5Vspinel to HE5050 and label inconsistency suggest using self-attention for adaptability without the complexity of openmax or SNGP. Moderate bottleneck and dropout balance capacity and regularization. Batch size 8 matches seen data, and warmup helps stabilize transfer learning."\n}'}
12-12 14:13:22 llm_cfg_stamp: 20251212_131825
12-12 14:13:22 pretrained_model_path: None
12-12 14:13:25 using 1 cpu
12-12 14:14:56 data_name: Battery_inconsistent
12-12 14:14:56 data_dir: ./my_datasets/Battery
12-12 14:14:56 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
12-12 14:14:56 normlizetype: mean-std
12-12 14:14:56 method: sngp
12-12 14:14:56 gp_hidden_dim: 2048
12-12 14:14:56 spectral_norm_bound: 0.95
12-12 14:14:56 n_power_iterations: 1
12-12 14:14:56 nesterov: True
12-12 14:14:56 print_freq: 10
12-12 14:14:56 layers: 16
12-12 14:14:56 widen_factor: 1
12-12 14:14:56 droprate: 0.35
12-12 14:14:56 cuda_device: 0
12-12 14:14:56 checkpoint_dir: ./checkpoint
12-12 14:14:56 pretrained: False
12-12 14:14:56 batch_size: 8
12-12 14:14:56 warmup_epochs: 3
12-12 14:14:56 num_workers: 0
12-12 14:14:56 bottleneck: True
12-12 14:14:56 bottleneck_num: 128
12-12 14:14:56 last_batch: False
12-12 14:14:56 hidden_size: 1024
12-12 14:14:56 trade_off_adversarial: Step
12-12 14:14:56 lam_adversarial: 1
12-12 14:14:56 opt: adam
12-12 14:14:56 lr: 0.0005
12-12 14:14:56 momentum: 0.9
12-12 14:14:56 weight_decay: 1e-05
12-12 14:14:56 lr_scheduler: step
12-12 14:14:56 gamma: 0.1
12-12 14:14:56 steps: 150, 250
12-12 14:14:56 middle_epoch: 15
12-12 14:14:56 max_epoch: 50
12-12 14:14:56 print_step: 25
12-12 14:14:56 inconsistent: UAN
12-12 14:14:56 model_name: cnn_features_1d_sa
12-12 14:14:56 th: 0.5
12-12 14:14:56 input_channels: 7
12-12 14:14:56 classification_label: eol_class
12-12 14:14:56 sequence_length: 32
12-12 14:14:56 cycles_per_file: 15
12-12 14:14:56 source_cycles_per_file: None
12-12 14:14:56 target_cycles_per_file: None
12-12 14:14:56 cycle_ablation: False
12-12 14:14:56 cycle_ablation_start: 5
12-12 14:14:56 cycle_ablation_step: 10
12-12 14:14:56 cycle_ablation_max: None
12-12 14:14:56 literature_context_file: ./references/joule_s2542-4351-22-00409-3.md
12-12 14:14:56 sample_random_state: 42
12-12 14:14:56 transfer_task: [[[0], [1]], [[0], [2]], [[0], [3]], [[1], [0]], [[1], [2]], [[1], [3]], [[2], [0]], [[2], [1]], [[2], [3]], [[3], [0]], [[3], [1]], [[3], [2]]]
12-12 14:14:56 source_cathode: ['5Vspinel']
12-12 14:14:56 target_cathode: []
12-12 14:14:56 num_classes: None
12-12 14:14:56 domain_temperature: 1.0
12-12 14:14:56 class_temperature: 10.0
12-12 14:14:56 lambda_src: 1.5
12-12 14:14:56 lambda_src_decay_patience: 5
12-12 14:14:56 lambda_src_decay_factor: 0.5
12-12 14:14:56 lambda_src_min: 0.0
12-12 14:14:56 lambda_src_warmup: 0
12-12 14:14:56 improvement_metric: accuracy
12-12 14:14:56 skip_retry: False
12-12 14:14:56 auto_select: True
12-12 14:14:56 llm_compare: True
12-12 14:14:56 llm_backend: openai
12-12 14:14:56 llm_model: None
12-12 14:14:56 llm_context: 
12-12 14:14:56 llm_ablation: False
12-12 14:14:56 llm_per_transfer: True
12-12 14:14:56 ablation_cycle_limits: 
12-12 14:14:56 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: 5Vspinel; target cathodes: Li1.2Ni0.3Mn0.6O2, Li1.35Ni0.33Mn0.67O2.35.\nLabel column 'eol_class' with ~None classes; sequence length 32; 21 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.\nLiterature cues (Joule S2542-4351(22)00409-3, chemistry-sensitive ablations):\nJoule 2022 (S2542-4351(22)00409-3) key cues for chemistry-aware ablation:\n- Early-cycle capacity fade slopes and coulombic-efficiency stabilization highlight whether aging is lithium-inventory loss (graphite/anode-electrolyte limited) versus cathode structural decay (e.g., Ni-rich NMC cathodes with electrolyte oxidation risk).\n- High initial impedance growth, thick SEI signatures, or electrolyte oxidation markers flag chemistries that benefit from uncertainty-aware heads (SNGP/OpenMax) to avoid overconfident extrapolation on outlier cycles.\n- LFP/graphite pairs tend to show flatter voltage plateaus and slower early fade; Ni-rich NMC chemistries degrade faster under aggressive cycling and need stronger regularization or shorter cycle horizons in ablations.\n- Transfer between mismatched chemistries (e.g., NMC → LFP) should down-weight source loss and favor architectures that adapt quickly with self-attention or wider bottlenecks; closely matched chemistries can rely more on convolutional baselines.\nsource_train: class counts 0:19, 1:18, 2:2, 3:1, 4:1 (example label 0).\nsource_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.5073000192642212, 0.29750001430511475, 0.1597999930381775, 0.11580000072717667, 0.06870000064373016, -0.0215000007301569, -0.06700000166893005, -0.0939000025391…\nsource_train flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]\ntarget_train: class counts 0:6 (example label 0).\ntarget_train sample window (first 3 ch × 12 steps): [[-1.896399974822998, -1.9917000532150269, -1.5246000289916992, 0.0, -0.8306000232696533, 0.0, -0.16660000383853912, 0.0, 0.17499999701976776, 0.2815000116825104, 0.4404999911785126, 0.287200003862381], [-2.2899999618530273, 2.789099931716919, 3.0618999004364014, 0.0, 2.724100112915039, 0.0, 1.9648000001907349, 0.0, 0.5493000149726868, 0.6560999751091003, -2.791300058364868, 2.6998000144958496], [-2.7012999057769775,…\ntarget_train flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]\nsource_val: class counts 0:5, 1:5, 2:1, 4:1 (example label 0).\nsource_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.3109000027179718, 0.25519999861717224, 0.11729999631643295, 0.027000000700354576, -0.023900000378489494, -0.09200000017881393, -0.14669999480247498, -0.17059999…\nsource_val flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]\ntarget_val: class counts 0:4 (example label 0).\ntarget_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 2.1417999267578125, 2.015700101852417, 1.9608999490737915, 2.140199899673462, 1.8382999897003174, 1.805999994277954, 3.2121999263763428, 1.5262000560760498, 1.592…\ntarget_val flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.0005, 'dropout_hint': 0.35, 'num_classes_hint': None, 'splits': {'source_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.5073000192642212, 0.29750001430511475, 0.1597999930381775, 0.11580000072717667, 0.06870000064373016, -0.0215000007301569, -0.06700000166893005, -0.09390000253915787, -0.14229999482631683, -0.26440000534057617, -0.26820001006126404], [-2.4202001094818115, 0.3971000015735626, 0.20489999651908875, 0.07859999686479568, 0.03830000013113022, -0.0044999998062849045, -0.0908999964594841, -0.1347000002861023, -0.15940000116825104, -0.20960000157356262, -0.3246999979019165, -0.32820001244544983]]}, 'batch_channel_mean': [0.8607000112533569, -0.1421000063419342, -0.2084999978542328, -0.07079999893903732, -0.16120000183582306, 0.534600019454956, -0.3154999911785126, 0.24279999732971191], 'batch_channel_std': [1.059499979019165, 0.5717999935150146, 0.5095999836921692, 0.6176000237464905, 0.5239999890327454, 0.9284999966621399, 0.7612000107765198, 0.8140000104904175], 'class_distribution': {'0': 19, '1': 18, '2': 2, '3': 1, '4': 1}, 'feature_range': [-2.9057923445856524, 5.202832943374929], 'feature_global_mean': -0.008143604364574682, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]}, 'target_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.896399974822998, -1.9917000532150269, -1.5246000289916992, 0.0, -0.8306000232696533, 0.0, -0.16660000383853912, 0.0, 0.17499999701976776, 0.2815000116825104, 0.4404999911785126, 0.287200003862381], [-2.2899999618530273, 2.789099931716919, 3.0618999004364014, 0.0, 2.724100112915039, 0.0, 1.9648000001907349, 0.0, 0.5493000149726868, 0.6560999751091003, -2.791300058364868, 2.6998000144958496], [-2.7012999057769775, 1.3554999828338623, 1.62090003490448, 0.0, 1.8700000047683716, 0.0, 1.3710999488830566, 0.0, 0.1671999990940094, 0.0502999983727932, -2.187700033187866, 0.9710999727249146]]}, 'batch_channel_mean': [0.7294999957084656, 0.8521999716758728, 1.1779999732971191, 0.9107999801635742, 1.1938999891281128, -0.11500000208616257, -0.24160000681877136, -0.2093999981880188], 'batch_channel_std': [1.037600040435791, 1.1383999586105347, 1.261199951171875, 1.3704999685287476, 1.382200002670288, 1.318600058555603, 1.0240000486373901, 1.1060999631881714], 'class_distribution': {'0': 6}, 'feature_range': [-3.6390493997246667, 19.875169049014566], 'feature_global_mean': 0.4374359295879304, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]}, 'source_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.3109000027179718, 0.25519999861717224, 0.11729999631643295, 0.027000000700354576, -0.023900000378489494, -0.09200000017881393, -0.14669999480247498, -0.17059999704360962, -0.19750000536441803, -0.23759999871253967, -0.2761000096797943], [-2.4202001094818115, 0.210999995470047, 0.16750000417232513, 0.040699999779462814, -0.04349999874830246, -0.09049999713897705, -0.15610000491142273, -0.20749999582767487, -0.2303999960422516, -0.26170000433921814, -0.3025999963283539, -0.33959999680519104]]}, 'batch_channel_mean': [0.8607000112533569, -0.14800000190734863, -0.21410000324249268, -0.1005999967455864, -0.1704999953508377, 0.7595000267028809, -0.25529998540878296, 0.00139999995008111], 'batch_channel_std': [1.059499979019165, 0.5544999837875366, 0.4968999922275543, 0.6308000087738037, 0.5254999995231628, 0.8083000183105469, 0.7978000044822693, 0.6376000046730042], 'class_distribution': {'0': 5, '1': 5, '2': 1, '4': 1}, 'feature_range': [-2.9057923445856524, 5.219029621397489], 'feature_global_mean': -0.004320963409587972, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]}, 'target_val': {'batch_shape': [4, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 2.1417999267578125, 2.015700101852417, 1.9608999490737915, 2.140199899673462, 1.8382999897003174, 1.805999994277954, 3.2121999263763428, 1.5262000560760498, 1.5922000408172607, 2.4560999870300293, 0.5361999869346619], [-2.4202001094818115, 2.6226999759674072, 2.5090999603271484, 2.4544999599456787, 2.5053000450134277, 2.200200080871582, 2.1552000045776367, 3.31030011177063, 1.7338000535964966, 1.7655999660491943, 2.470400094985962, 0.6173999905586243]]}, 'batch_channel_mean': [0.8607000112533569, 0.8479999899864197, 1.1744999885559082, 0.14030000567436218, 0.7558000087738037, -0.8087999820709229, -0.2743000090122223, -0.7925999760627747], 'batch_channel_std': [1.059499979019165, 1.2324999570846558, 1.3095999956130981, 1.6520999670028687, 1.822100043296814, 0.26759999990463257, 0.8853999972343445, 1.1957999467849731], 'class_distribution': {'0': 4}, 'feature_range': [-3.571829448600409, 19.622460716154905], 'feature_global_mean': 0.28418790425941914, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]}}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': ['5Vspinel'], 'target_cathodes': ['Li1.2Ni0.3Mn0.6O2', 'Li1.35Ni0.33Mn0.67O2.35'], 'label_column': 'eol_class', 'split_used': 'source_train', 'batch_size_seen': 8, 'channels': 21, 'seq_len': 32}}
12-12 14:14:56 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 128, 'dropout': 0.35, 'learning_rate': 0.0005, 'batch_size': 8, 'lambda_src': 1.5, 'warmup_epochs': 10, 'rationale': 'The dataset has 21 channels and short sequence length (32), favoring CNN with self-attention to capture local and some global dependencies. The chemistry mismatch and label inconsistency suggest benefit from self-attention for adaptation without the complexity of OpenMax or SNGP. Moderate bottleneck and dropout balance capacity and regularization to avoid overfitting small source domain. Batch size 8 matches seen data, and warmup stabilizes transfer learning. Target cathode: Li1.2Ni0.3Mn0.6O2. Source cathodes: 5Vspinel (high-voltage spinel (manganese rich)). Source/target chemistries differ → expect domain shift. Evaluated 21 channels × 32-step windows and matched them with cnn_1d_sa capacity. Target fine-tune spans ≈6 cycles versus 41 source cycles, guiding lr=5.00e-04 and dropout=0.35.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 128,\n  "dropout": 0.35,\n  "learning_rate": 0.0005,\n  "batch_size": 8,\n  "lambda_src": 1.0,\n  "warmup_epochs": 10,\n  "rationale": "The dataset has 21 channels and short sequence length (32), favoring CNN with self-attention to capture local and some global dependencies. The chemistry mismatch and label inconsistency suggest benefit from self-attention for adaptation without the complexity of OpenMax or SNGP. Moderate bottleneck and dropout balance capacity and regularization to avoid overfitting small source domain. Batch size 8 matches seen data, and warmup stabilizes transfer learning."\n}'}
12-12 14:14:56 llm_cfg_stamp: 20251212_131825
12-12 14:14:56 pretrained_model_path: None
12-12 14:14:58 using 1 cpu
12-12 14:28:33 data_name: Battery_inconsistent
12-12 14:28:33 data_dir: ./my_datasets/Battery
12-12 14:28:33 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
12-12 14:28:33 normlizetype: mean-std
12-12 14:28:33 method: sngp
12-12 14:28:33 gp_hidden_dim: 2048
12-12 14:28:33 spectral_norm_bound: 0.95
12-12 14:28:33 n_power_iterations: 1
12-12 14:28:33 nesterov: True
12-12 14:28:33 print_freq: 10
12-12 14:28:33 layers: 16
12-12 14:28:33 widen_factor: 1
12-12 14:28:33 droprate: 0.35
12-12 14:28:33 cuda_device: 0
12-12 14:28:33 checkpoint_dir: ./checkpoint
12-12 14:28:33 pretrained: False
12-12 14:28:33 batch_size: 8
12-12 14:28:33 warmup_epochs: 3
12-12 14:28:33 num_workers: 0
12-12 14:28:33 bottleneck: True
12-12 14:28:33 bottleneck_num: 256
12-12 14:28:33 last_batch: False
12-12 14:28:33 hidden_size: 1024
12-12 14:28:33 trade_off_adversarial: Step
12-12 14:28:33 lam_adversarial: 1
12-12 14:28:33 opt: adam
12-12 14:28:33 lr: 0.0005
12-12 14:28:33 momentum: 0.9
12-12 14:28:33 weight_decay: 1e-05
12-12 14:28:33 lr_scheduler: step
12-12 14:28:33 gamma: 0.1
12-12 14:28:33 steps: 150, 250
12-12 14:28:33 middle_epoch: 15
12-12 14:28:33 max_epoch: 50
12-12 14:28:33 print_step: 25
12-12 14:28:33 inconsistent: UAN
12-12 14:28:33 model_name: cnn_features_1d_sa
12-12 14:28:33 th: 0.5
12-12 14:28:33 input_channels: 7
12-12 14:28:33 classification_label: eol_class
12-12 14:28:33 sequence_length: 32
12-12 14:28:33 cycles_per_file: 15
12-12 14:28:33 source_cycles_per_file: None
12-12 14:28:33 target_cycles_per_file: None
12-12 14:28:33 cycle_ablation: False
12-12 14:28:33 cycle_ablation_start: 5
12-12 14:28:33 cycle_ablation_step: 10
12-12 14:28:33 cycle_ablation_max: None
12-12 14:28:33 literature_context_file: ./references/joule_s2542-4351-22-00409-3.md
12-12 14:28:33 sample_random_state: 42
12-12 14:28:33 transfer_task: [[[0], [1]], [[0], [2]], [[0], [3]], [[1], [0]], [[1], [2]], [[1], [3]], [[2], [0]], [[2], [1]], [[2], [3]], [[3], [0]], [[3], [1]], [[3], [2]]]
12-12 14:28:33 source_cathode: ['5Vspinel']
12-12 14:28:33 target_cathode: []
12-12 14:28:33 num_classes: None
12-12 14:28:33 domain_temperature: 1.0
12-12 14:28:33 class_temperature: 10.0
12-12 14:28:33 lambda_src: 0.6
12-12 14:28:33 lambda_src_decay_patience: 5
12-12 14:28:33 lambda_src_decay_factor: 0.5
12-12 14:28:33 lambda_src_min: 0.0
12-12 14:28:33 lambda_src_warmup: 0
12-12 14:28:33 improvement_metric: accuracy
12-12 14:28:33 skip_retry: False
12-12 14:28:33 auto_select: True
12-12 14:28:33 llm_compare: True
12-12 14:28:33 llm_backend: openai
12-12 14:28:33 llm_model: None
12-12 14:28:33 llm_context: 
12-12 14:28:33 llm_ablation: False
12-12 14:28:33 llm_per_transfer: True
12-12 14:28:33 ablation_cycle_limits: 
12-12 14:28:33 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: 5Vspinel; target cathodes: HE5050, NMC111, NMC532, NMC622, NMC811.\nLabel column 'eol_class' with ~None classes; sequence length 32; 21 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.\nLiterature cues (Joule S2542-4351(22)00409-3, chemistry-sensitive ablations):\nJoule 2022 (S2542-4351(22)00409-3) key cues for chemistry-aware ablation:\n- Early-cycle capacity fade slopes and coulombic-efficiency stabilization highlight whether aging is lithium-inventory loss (graphite/anode-electrolyte limited) versus cathode structural decay (e.g., Ni-rich NMC cathodes with electrolyte oxidation risk).\n- High initial impedance growth, thick SEI signatures, or electrolyte oxidation markers flag chemistries that benefit from uncertainty-aware heads (SNGP/OpenMax) to avoid overconfident extrapolation on outlier cycles.\n- LFP/graphite pairs tend to show flatter voltage plateaus and slower early fade; Ni-rich NMC chemistries degrade faster under aggressive cycling and need stronger regularization or shorter cycle horizons in ablations.\n- Transfer between mismatched chemistries (e.g., NMC → LFP) should down-weight source loss and favor architectures that adapt quickly with self-attention or wider bottlenecks; closely matched chemistries can rely more on convolutional baselines.\nsource_train: class counts 0:19, 1:18, 2:2, 3:1, 4:1 (example label 1).\nsource_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.03319999948143959, 0.03240000084042549, 0.010200000368058681, 0.0005000000237487257, -0.00279999990016222, -0.009200000204145908, -0.019200000911951065, -0.0222…\nsource_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_train: class counts 0:22, 1:22, 2:38, 3:34, 4:39 (example label 1).\ntarget_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.0851999521255493, -1.0836000442504883, -1.0839999914169312, -1.0845999717712402, -1.0846999883651733, -1.0848000049591064, -1.0857000350952148, -1.085700035095…\ntarget_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]\nsource_val: class counts 0:5, 1:5, 2:1, 4:1 (example label 0).\nsource_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759…\nsource_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_val: class counts 0:9, 1:10, 2:19, 3:17, 4:19 (example label 3).\ntarget_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.174100041389…\ntarget_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.0005, 'dropout_hint': 0.35, 'num_classes_hint': None, 'splits': {'source_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.03319999948143959, 0.03240000084042549, 0.010200000368058681, 0.0005000000237487257, -0.00279999990016222, -0.009200000204145908, -0.019200000911951065, -0.022299999371170998, -0.024399999529123306, -0.038600001484155655, -0.041200000792741776], [-1.13100004196167, -0.13539999723434448, -0.13030000030994415, -0.149399995803833, -0.15809999406337738, -0.16099999845027924, -0.16779999434947968, -0.17669999599456787, -0.17949999868869781, -0.18289999663829803, -0.195700004696846, -0.1979999989271164]]}, 'batch_channel_mean': [0.8607000112533569, -0.2655999958515167, -0.3587999939918518, -0.2363000065088272, -0.3619999885559082, 0.9797999858856201, -0.1062999963760376, 0.09290000051259995], 'batch_channel_std': [1.059499979019165, 0.2797999978065491, 0.21699999272823334, 0.2978000044822693, 0.21809999644756317, 1.1097999811172485, 0.8382999897003174, 0.9832000136375427], 'class_distribution': {'0': 19, '1': 18, '2': 2, '3': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1401425697203385], 'feature_global_mean': -0.016921664518018544, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.0851999521255493, -1.0836000442504883, -1.0839999914169312, -1.0845999717712402, -1.0846999883651733, -1.0848000049591064, -1.0857000350952148, -1.0857000350952148, -1.086400032043457, -1.0885000228881836, -1.0885000228881836], [-1.13100004196167, -1.0427000522613525, -1.0407999753952026, -1.041200041770935, -1.0419000387191772, -1.0420000553131104, -1.042199969291687, -1.0432000160217285, -1.0433000326156616, -1.0440000295639038, -1.0463000535964966, -1.0463999509811401]]}, 'batch_channel_mean': [0.8607000112533569, 0.427700012922287, 0.4577000141143799, 0.4221999943256378, 0.46560001373291016, 0.6165000200271606, -0.2732999920845032, -0.026900000870227814], 'batch_channel_std': [1.059499979019165, 1.77839994430542, 1.783400058746338, 1.8186999559402466, 1.8009999990463257, 0.8043000102043152, 0.7856000065803528, 0.6467000246047974], 'class_distribution': {'0': 22, '1': 22, '2': 38, '3': 34, '4': 39}, 'feature_range': [-9.981793547102113, 31.866555053073082], 'feature_global_mean': 0.043367023845691036, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}, 'source_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759999334812164, -0.2379000037908554, -0.2531999945640564, -0.2678999900817871], [-1.13100004196167, -0.19740000367164612, -0.21279999613761902, -0.25780001282691956, -0.28760001063346863, -0.3043000102043152, -0.32760000228881836, -0.3458000123500824, -0.3540000021457672, -0.3650999963283539, -0.37959998846054077, -0.3926999866962433]]}, 'batch_channel_mean': [0.8607000112533569, -0.21899999678134918, -0.3481999933719635, -0.1915999948978424, -0.34689998626708984, 1.118899941444397, -0.11599999666213989, 0.016499999910593033], 'batch_channel_std': [1.059499979019165, 0.21160000562667847, 0.17630000412464142, 0.2303999960422516, 0.17829999327659607, 0.9266999959945679, 0.8331000208854675, 0.7063000202178955], 'class_distribution': {'0': 5, '1': 5, '2': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1560300164083985], 'feature_global_mean': -0.010901597356338598, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 3, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653], [-1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167]]}, 'batch_channel_mean': [0.8607000112533569, 0.27559998631477356, 0.2630000114440918, 0.1655000001192093, 0.2653000056743622, 0.005200000014156103, -0.3278999924659729, -0.6205999851226807], 'batch_channel_std': [1.059499979019165, 0.4851999878883362, 0.47620001435279846, 0.46309998631477356, 0.47749999165534973, 0.9384999871253967, 0.8022000193595886, 0.9699000120162964], 'class_distribution': {'0': 9, '1': 10, '2': 19, '3': 17, '4': 19}, 'feature_range': [-3.426709644883315, 32.206823553376644], 'feature_global_mean': 0.014365731412246173, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': ['5Vspinel'], 'target_cathodes': ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811'], 'label_column': 'eol_class', 'split_used': 'source_train', 'batch_size_seen': 8, 'channels': 21, 'seq_len': 32}}
12-12 14:28:33 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 256, 'dropout': 0.35, 'learning_rate': 0.0005, 'batch_size': 8, 'lambda_src': 0.6, 'warmup_epochs': 10, 'rationale': 'The dataset has 21 channels and short sequence length (32), favoring a CNN backbone with self-attention to capture multi-cycle correlations and domain shifts between chemistries. Self-attention balances expressivity and efficiency without excessive memory use. Dropout at 0.35 mitigates overfitting on the small source domain. OpenMax or SNGP are less critical here since the label inconsistency is moderate and the focus is on transfer learning, so a standard unknown head is not used. A moderate bottleneck (256) supports adaptation to domain shift while maintaining capacity. Target cathode: HE5050 (high-energy experimental blend). Source cathodes: 5Vspinel (high-voltage spinel (manganese rich)). Source/target chemistries differ → expect domain shift. Evaluated 21 channels × 32-step windows and matched them with cnn_1d_sa capacity. Target fine-tune spans ≈155 cycles versus 41 source cycles, guiding lr=5.00e-04 and dropout=0.35.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 256,\n  "dropout": 0.35,\n  "learning_rate": 0.0005,\n  "batch_size": 8,\n  "lambda_src": 1.0,\n  "warmup_epochs": 10,\n  "rationale": "The dataset has 21 channels and short sequence length (32), favoring a CNN backbone with self-attention to capture multi-cycle correlations and domain shifts between chemistries. Self-attention balances expressivity and efficiency without excessive memory use. Dropout at 0.35 mitigates overfitting on the small source domain. OpenMax or SNGP are less critical here since the label inconsistency is moderate and the focus is on transfer learning, so a standard unknown head is not used. A moderate bottleneck (256) supports adaptation to domain shift while maintaining capacity."\n}'}
12-12 14:28:33 llm_cfg_stamp: 20251212_131825
12-12 14:28:33 tag: no_sa_20251212_131825
12-12 14:28:33 pretrained_model_path: None
12-12 14:28:36 using 1 cpu
12-12 15:17:31 data_name: Battery_inconsistent
12-12 15:17:31 data_dir: ./my_datasets/Battery
12-12 15:17:31 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
12-12 15:17:31 normlizetype: mean-std
12-12 15:17:31 method: sngp
12-12 15:17:31 gp_hidden_dim: 2048
12-12 15:17:31 spectral_norm_bound: 0.95
12-12 15:17:31 n_power_iterations: 1
12-12 15:17:31 nesterov: True
12-12 15:17:31 print_freq: 10
12-12 15:17:31 layers: 16
12-12 15:17:31 widen_factor: 1
12-12 15:17:31 droprate: 0.35
12-12 15:17:31 cuda_device: 0
12-12 15:17:31 checkpoint_dir: ./checkpoint
12-12 15:17:31 pretrained: False
12-12 15:17:31 batch_size: 8
12-12 15:17:31 warmup_epochs: 3
12-12 15:17:31 num_workers: 0
12-12 15:17:31 bottleneck: True
12-12 15:17:31 bottleneck_num: 256
12-12 15:17:31 last_batch: False
12-12 15:17:31 hidden_size: 1024
12-12 15:17:31 trade_off_adversarial: Step
12-12 15:17:31 lam_adversarial: 1
12-12 15:17:31 opt: adam
12-12 15:17:31 lr: 0.0005
12-12 15:17:31 momentum: 0.9
12-12 15:17:31 weight_decay: 1e-05
12-12 15:17:31 lr_scheduler: step
12-12 15:17:31 gamma: 0.1
12-12 15:17:31 steps: 150, 250
12-12 15:17:31 middle_epoch: 15
12-12 15:17:31 max_epoch: 50
12-12 15:17:31 print_step: 25
12-12 15:17:31 inconsistent: UAN
12-12 15:17:31 model_name: cnn_features_1d_sa
12-12 15:17:31 th: 0.5
12-12 15:17:31 input_channels: 7
12-12 15:17:31 classification_label: eol_class
12-12 15:17:31 sequence_length: 32
12-12 15:17:31 cycles_per_file: 15
12-12 15:17:31 source_cycles_per_file: None
12-12 15:17:31 target_cycles_per_file: None
12-12 15:17:31 cycle_ablation: False
12-12 15:17:31 cycle_ablation_start: 5
12-12 15:17:31 cycle_ablation_step: 10
12-12 15:17:31 cycle_ablation_max: None
12-12 15:17:31 literature_context_file: ./references/joule_s2542-4351-22-00409-3.md
12-12 15:17:31 sample_random_state: 42
12-12 15:17:31 transfer_task: [[[0], [1]], [[0], [2]], [[0], [3]], [[1], [0]], [[1], [2]], [[1], [3]], [[2], [0]], [[2], [1]], [[2], [3]], [[3], [0]], [[3], [1]], [[3], [2]]]
12-12 15:17:31 source_cathode: ['5Vspinel']
12-12 15:17:31 target_cathode: []
12-12 15:17:31 num_classes: None
12-12 15:17:31 domain_temperature: 1.0
12-12 15:17:31 class_temperature: 10.0
12-12 15:17:31 lambda_src: 1.5
12-12 15:17:31 lambda_src_decay_patience: 5
12-12 15:17:31 lambda_src_decay_factor: 0.5
12-12 15:17:31 lambda_src_min: 0.0
12-12 15:17:31 lambda_src_warmup: 0
12-12 15:17:31 improvement_metric: accuracy
12-12 15:17:31 skip_retry: False
12-12 15:17:31 auto_select: True
12-12 15:17:31 llm_compare: True
12-12 15:17:31 llm_backend: openai
12-12 15:17:31 llm_model: None
12-12 15:17:31 llm_context: 
12-12 15:17:31 llm_ablation: False
12-12 15:17:31 llm_per_transfer: True
12-12 15:17:31 ablation_cycle_limits: 
12-12 15:17:31 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: 5Vspinel; target cathodes: Li1.2Ni0.3Mn0.6O2, Li1.35Ni0.33Mn0.67O2.35.\nLabel column 'eol_class' with ~None classes; sequence length 32; 21 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.\nLiterature cues (Joule S2542-4351(22)00409-3, chemistry-sensitive ablations):\nJoule 2022 (S2542-4351(22)00409-3) key cues for chemistry-aware ablation:\n- Early-cycle capacity fade slopes and coulombic-efficiency stabilization highlight whether aging is lithium-inventory loss (graphite/anode-electrolyte limited) versus cathode structural decay (e.g., Ni-rich NMC cathodes with electrolyte oxidation risk).\n- High initial impedance growth, thick SEI signatures, or electrolyte oxidation markers flag chemistries that benefit from uncertainty-aware heads (SNGP/OpenMax) to avoid overconfident extrapolation on outlier cycles.\n- LFP/graphite pairs tend to show flatter voltage plateaus and slower early fade; Ni-rich NMC chemistries degrade faster under aggressive cycling and need stronger regularization or shorter cycle horizons in ablations.\n- Transfer between mismatched chemistries (e.g., NMC → LFP) should down-weight source loss and favor architectures that adapt quickly with self-attention or wider bottlenecks; closely matched chemistries can rely more on convolutional baselines.\nsource_train: class counts 0:19, 1:18, 2:2, 3:1, 4:1 (example label 2).\nsource_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.14630000293254852, 0.07519999891519547, -2.6510000228881836, 0.012799999676644802, -0.2791000008583069, -0.01119999960064888, -0.011500000022351742, 0.001200000…\nsource_train flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]\ntarget_train: class counts 0:6 (example label 0).\ntarget_train sample window (first 3 ch × 12 steps): [[-1.896399974822998, -2.010499954223633, -1.5264999866485596, 0.0, -0.8173999786376953, 0.0, -0.06809999793767929, 0.0, 0.2856000065803528, 0.34790000319480896, 0.5138000249862671, 0.696399986743927], [-2.2899999618530273, 3.247299909591675, 3.219599962234497, 0.0, 2.822499990463257, 0.0, 1.9033000469207764, 0.0, 1.7319999933242798, 1.4701999425888062, 1.604599952697754, -0.8252999782562256], [-2.7012999057769775, 1…\ntarget_train flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]\nsource_val: class counts 0:5, 1:5, 2:1, 4:1 (example label 0).\nsource_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.3109000027179718, 0.25519999861717224, 0.11729999631643295, 0.027000000700354576, -0.023900000378489494, -0.09200000017881393, -0.14669999480247498, -0.17059999…\nsource_val flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]\ntarget_val: class counts 0:4 (example label 0).\ntarget_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 2.1417999267578125, 2.015700101852417, 1.9608999490737915, 2.140199899673462, 1.8382999897003174, 1.805999994277954, 3.2121999263763428, 1.5262000560760498, 1.592…\ntarget_val flattened row glimpses: [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.0005, 'dropout_hint': 0.35, 'num_classes_hint': None, 'splits': {'source_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 2, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.14630000293254852, 0.07519999891519547, -2.6510000228881836, 0.012799999676644802, -0.2791000008583069, -0.01119999960064888, -0.011500000022351742, 0.0012000000569969416, 0.0003000000142492354, -0.008899999782443047, -0.018300000578165054], [-2.4202001094818115, 0.0414000004529953, -0.011800000444054604, -2.420099973678589, -0.094200000166893, -0.3474000096321106, -0.09600000083446503, -0.09610000252723694, -0.0843999981880188, -0.0851999968290329, -0.09309999644756317, -0.10279999673366547]]}, 'batch_channel_mean': [0.8607000112533569, -0.10819999873638153, -0.17669999599456787, -0.01860000006854534, -0.12030000239610672, 0.5947999954223633, -0.29600000381469727, 0.32420000433921814], 'batch_channel_std': [1.059499979019165, 0.5400000214576721, 0.4787999987602234, 0.5626999735832214, 0.483599990606308, 0.9283000230789185, 0.7759000062942505, 0.7864000201225281], 'class_distribution': {'0': 19, '1': 18, '2': 2, '3': 1, '4': 1}, 'feature_range': [-2.9057923445856524, 5.202832943374929], 'feature_global_mean': -0.008143604364574682, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]}, 'target_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.896399974822998, -2.010499954223633, -1.5264999866485596, 0.0, -0.8173999786376953, 0.0, -0.06809999793767929, 0.0, 0.2856000065803528, 0.34790000319480896, 0.5138000249862671, 0.696399986743927], [-2.2899999618530273, 3.247299909591675, 3.219599962234497, 0.0, 2.822499990463257, 0.0, 1.9033000469207764, 0.0, 1.7319999933242798, 1.4701999425888062, 1.604599952697754, -0.8252999782562256], [-2.7012999057769775, 1.7355999946594238, 1.8173999786376953, 0.0, 2.0676000118255615, 0.0, 1.989300012588501, 0.0, 1.4453999996185303, 0.8960999846458435, 0.3228999972343445, -1.125100016593933]]}, 'batch_channel_mean': [0.707099974155426, 0.8895000219345093, 1.1301000118255615, 0.8313000202178955, 1.0865999460220337, -0.09960000216960907, -0.017400000244379044, -0.5198000073432922], 'batch_channel_std': [1.030500054359436, 1.198199987411499, 1.2407000064849854, 1.3655999898910522, 1.382200002670288, 1.2339999675750732, 1.2590999603271484, 0.8029000163078308], 'class_distribution': {'0': 6}, 'feature_range': [-3.6390493997246667, 19.875169049014566], 'feature_global_mean': 0.4374359295879304, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]}, 'source_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 0.3109000027179718, 0.25519999861717224, 0.11729999631643295, 0.027000000700354576, -0.023900000378489494, -0.09200000017881393, -0.14669999480247498, -0.17059999704360962, -0.19750000536441803, -0.23759999871253967, -0.2761000096797943], [-2.4202001094818115, 0.210999995470047, 0.16750000417232513, 0.040699999779462814, -0.04349999874830246, -0.09049999713897705, -0.15610000491142273, -0.20749999582767487, -0.2303999960422516, -0.26170000433921814, -0.3025999963283539, -0.33959999680519104]]}, 'batch_channel_mean': [0.8607000112533569, -0.14800000190734863, -0.21410000324249268, -0.1005999967455864, -0.1704999953508377, 0.7595000267028809, -0.25529998540878296, 0.00139999995008111], 'batch_channel_std': [1.059499979019165, 0.5544999837875366, 0.4968999922275543, 0.6308000087738037, 0.5254999995231628, 0.8083000183105469, 0.7978000044822693, 0.6376000046730042], 'class_distribution': {'0': 5, '1': 5, '2': 1, '4': 1}, 'feature_range': [-2.9057923445856524, 5.219029621397489], 'feature_global_mean': -0.004320963409587972, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9417, -2.9058, -2.8748, -0.1784]]}, 'target_val': {'batch_shape': [4, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-2.6510000228881836, 2.1417999267578125, 2.015700101852417, 1.9608999490737915, 2.140199899673462, 1.8382999897003174, 1.805999994277954, 3.2121999263763428, 1.5262000560760498, 1.5922000408172607, 2.4560999870300293, 0.5361999869346619], [-2.4202001094818115, 2.6226999759674072, 2.5090999603271484, 2.4544999599456787, 2.5053000450134277, 2.200200080871582, 2.1552000045776367, 3.31030011177063, 1.7338000535964966, 1.7655999660491943, 2.470400094985962, 0.6173999905586243]]}, 'batch_channel_mean': [0.8607000112533569, 0.8479999899864197, 1.1744999885559082, 0.14030000567436218, 0.7558000087738037, -0.8087999820709229, -0.2743000090122223, -0.7925999760627747], 'batch_channel_std': [1.059499979019165, 1.2324999570846558, 1.3095999956130981, 1.6520999670028687, 1.822100043296814, 0.26759999990463257, 0.8853999972343445, 1.1957999467849731], 'class_distribution': {'0': 4}, 'feature_range': [-3.571829448600409, 19.622460716154905], 'feature_global_mean': 0.28418790425941914, 'flattened_rows_head': [[-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784], [-1.6202, -2.651, -2.4202, -2.7228, -2.4601, -1.489, -0.9406, -2.9058, -2.8748, -0.1784]]}}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': ['5Vspinel'], 'target_cathodes': ['Li1.2Ni0.3Mn0.6O2', 'Li1.35Ni0.33Mn0.67O2.35'], 'label_column': 'eol_class', 'split_used': 'source_train', 'batch_size_seen': 8, 'channels': 21, 'seq_len': 32}}
12-12 15:17:31 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 256, 'dropout': 0.35, 'learning_rate': 0.0005, 'batch_size': 8, 'lambda_src': 1.5, 'warmup_epochs': 10, 'rationale': 'The dataset has 21 channels and short sequence length (32), favoring a CNN with self-attention to capture local and some global dependencies. Self-attention helps adapt to domain shift between source and target cathodes. Moderate bottleneck and dropout balance capacity and regularization given label inconsistency. OpenMax or SNGP are less critical here since the main challenge is transfer learning rather than open-set detection. Batch size 8 matches seen data, and warmup aids stable transfer. Target cathode: Li1.2Ni0.3Mn0.6O2. Source cathodes: 5Vspinel (high-voltage spinel (manganese rich)). Source/target chemistries differ → expect domain shift. Evaluated 21 channels × 32-step windows and matched them with cnn_1d_sa capacity. Target fine-tune spans ≈6 cycles versus 41 source cycles, guiding lr=5.00e-04 and dropout=0.35.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 256,\n  "dropout": 0.35,\n  "learning_rate": 0.0005,\n  "batch_size": 8,\n  "lambda_src": 1.0,\n  "warmup_epochs": 10,\n  "rationale": "The dataset has 21 channels and short sequence length (32), favoring a CNN with self-attention to capture local and some global dependencies. Self-attention helps adapt to domain shift between source and target cathodes. Moderate bottleneck and dropout balance capacity and regularization given label inconsistency. OpenMax or SNGP are less critical here since the main challenge is transfer learning rather than open-set detection. Batch size 8 matches seen data, and warmup aids stable transfer."\n}'}
12-12 15:17:31 llm_cfg_stamp: 20251212_131825
12-12 15:17:31 tag: no_sngp_20251212_131825
12-12 15:17:31 pretrained_model_path: None
12-12 15:17:34 using 1 cpu
12-12 15:29:27 data_name: Battery_inconsistent
12-12 15:29:27 data_dir: ./my_datasets/Battery
12-12 15:29:27 csv: ./my_datasets/Battery/battery_cycles_labeled.csv
12-12 15:29:27 normlizetype: mean-std
12-12 15:29:27 method: sngp
12-12 15:29:27 gp_hidden_dim: 2048
12-12 15:29:27 spectral_norm_bound: 0.95
12-12 15:29:27 n_power_iterations: 1
12-12 15:29:27 nesterov: True
12-12 15:29:27 print_freq: 10
12-12 15:29:27 layers: 16
12-12 15:29:27 widen_factor: 1
12-12 15:29:27 droprate: 0.35
12-12 15:29:27 cuda_device: 0
12-12 15:29:27 checkpoint_dir: ./checkpoint
12-12 15:29:27 pretrained: False
12-12 15:29:27 batch_size: 8
12-12 15:29:27 warmup_epochs: 3
12-12 15:29:27 num_workers: 0
12-12 15:29:27 bottleneck: True
12-12 15:29:27 bottleneck_num: 256
12-12 15:29:27 last_batch: False
12-12 15:29:27 hidden_size: 1024
12-12 15:29:27 trade_off_adversarial: Step
12-12 15:29:27 lam_adversarial: 1
12-12 15:29:27 opt: adam
12-12 15:29:27 lr: 0.0005
12-12 15:29:27 momentum: 0.9
12-12 15:29:27 weight_decay: 1e-05
12-12 15:29:27 lr_scheduler: step
12-12 15:29:27 gamma: 0.1
12-12 15:29:27 steps: 150, 250
12-12 15:29:27 middle_epoch: 15
12-12 15:29:27 max_epoch: 50
12-12 15:29:27 print_step: 25
12-12 15:29:27 inconsistent: UAN
12-12 15:29:27 model_name: cnn_features_1d_sa
12-12 15:29:27 th: 0.5
12-12 15:29:27 input_channels: 7
12-12 15:29:27 classification_label: eol_class
12-12 15:29:27 sequence_length: 32
12-12 15:29:27 cycles_per_file: 15
12-12 15:29:27 source_cycles_per_file: None
12-12 15:29:27 target_cycles_per_file: None
12-12 15:29:27 cycle_ablation: False
12-12 15:29:27 cycle_ablation_start: 5
12-12 15:29:27 cycle_ablation_step: 10
12-12 15:29:27 cycle_ablation_max: None
12-12 15:29:27 literature_context_file: ./references/joule_s2542-4351-22-00409-3.md
12-12 15:29:27 sample_random_state: 42
12-12 15:29:27 transfer_task: [[[0], [1]], [[0], [2]], [[0], [3]], [[1], [0]], [[1], [2]], [[1], [3]], [[2], [0]], [[2], [1]], [[2], [3]], [[3], [0]], [[3], [1]], [[3], [2]]]
12-12 15:29:27 source_cathode: ['5Vspinel']
12-12 15:29:27 target_cathode: []
12-12 15:29:27 num_classes: None
12-12 15:29:27 domain_temperature: 1.0
12-12 15:29:27 class_temperature: 10.0
12-12 15:29:27 lambda_src: 0.6
12-12 15:29:27 lambda_src_decay_patience: 5
12-12 15:29:27 lambda_src_decay_factor: 0.5
12-12 15:29:27 lambda_src_min: 0.0
12-12 15:29:27 lambda_src_warmup: 0
12-12 15:29:27 improvement_metric: accuracy
12-12 15:29:27 skip_retry: False
12-12 15:29:27 auto_select: True
12-12 15:29:27 llm_compare: True
12-12 15:29:27 llm_backend: openai
12-12 15:29:27 llm_model: None
12-12 15:29:27 llm_context: 
12-12 15:29:27 llm_ablation: False
12-12 15:29:27 llm_per_transfer: True
12-12 15:29:27 ablation_cycle_limits: 
12-12 15:29:27 llm_cfg_inputs: {'text_context': "Dataset: Argonne National Laboratory battery aging time-series with partial cycle windows.\nSource cathodes: 5Vspinel; target cathodes: HE5050, NMC111, NMC532, NMC622, NMC811.\nLabel column 'eol_class' with ~None classes; sequence length 32; 21 channels covering cycle_number, energy_charge, capacity_charge, energy_discharge, capacity_discharge, cycle_start, cycle_duration.\nLiterature cues (Joule S2542-4351(22)00409-3, chemistry-sensitive ablations):\nJoule 2022 (S2542-4351(22)00409-3) key cues for chemistry-aware ablation:\n- Early-cycle capacity fade slopes and coulombic-efficiency stabilization highlight whether aging is lithium-inventory loss (graphite/anode-electrolyte limited) versus cathode structural decay (e.g., Ni-rich NMC cathodes with electrolyte oxidation risk).\n- High initial impedance growth, thick SEI signatures, or electrolyte oxidation markers flag chemistries that benefit from uncertainty-aware heads (SNGP/OpenMax) to avoid overconfident extrapolation on outlier cycles.\n- LFP/graphite pairs tend to show flatter voltage plateaus and slower early fade; Ni-rich NMC chemistries degrade faster under aggressive cycling and need stronger regularization or shorter cycle horizons in ablations.\n- Transfer between mismatched chemistries (e.g., NMC → LFP) should down-weight source loss and favor architectures that adapt quickly with self-attention or wider bottlenecks; closely matched chemistries can rely more on convolutional baselines.\nsource_train: class counts 0:19, 1:18, 2:2, 3:1, 4:1 (example label 1).\nsource_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.016899999231100082, 0.0012000000569969416, -0.030400000512599945, -0.03880000114440918, -0.04360000044107437, -0.05829999968409538, -0.0729999989271164, -0.074…\nsource_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_train: class counts 0:22, 1:22, 2:38, 3:34, 4:39 (example label 1).\ntarget_train sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.3743000030517578, 0.37630000710487366, 0.3709999918937683, 0.3490999937057495, 0.34459999203681946, 0.34619998931884766, 0.32109999656677246, 0.3179000020027160…\ntarget_train flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]\nsource_val: class counts 0:5, 1:5, 2:1, 4:1 (example label 0).\nsource_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759…\nsource_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]\ntarget_val: class counts 0:9, 1:10, 2:19, 3:17, 4:19 (example label 3).\ntarget_val sample window (first 3 ch × 12 steps): [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.174100041389…\ntarget_val flattened row glimpses: [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]", 'numeric_summary': {'dataset': 'Battery_inconsistent', 'sequence_length_requested': 32, 'notes': 'label_inconsistent', 'lr_hint': 0.0005, 'dropout_hint': 0.35, 'num_classes_hint': None, 'splits': {'source_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.016899999231100082, 0.0012000000569969416, -0.030400000512599945, -0.03880000114440918, -0.04360000044107437, -0.05829999968409538, -0.0729999989271164, -0.07419999688863754, -0.07940000295639038, -0.10239999741315842, -0.11169999837875366], [-1.13100004196167, -0.17839999496936798, -0.15639999508857727, -0.18359999358654022, -0.19140000641345978, -0.195700004696846, -0.20919999480247498, -0.22220000624656677, -0.22349999845027924, -0.22930000722408295, -0.2498999983072281, -0.25760000944137573]]}, 'batch_channel_mean': [0.8607000112533569, -0.19619999825954437, -0.3012000024318695, -0.15970000624656677, -0.301800012588501, 0.9627000093460083, -0.1062999963760376, 0.14169999957084656], 'batch_channel_std': [1.059499979019165, 0.24040000140666962, 0.17249999940395355, 0.25209999084472656, 0.17270000278949738, 1.1347999572753906, 0.824999988079071, 0.6575999855995178], 'class_distribution': {'0': 19, '1': 18, '2': 2, '3': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1401425697203385], 'feature_global_mean': -0.016921664518018544, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_train': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 1, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, 0.3743000030517578, 0.37630000710487366, 0.3709999918937683, 0.3490999937057495, 0.34459999203681946, 0.34619998931884766, 0.32109999656677246, 0.31790000200271606, 0.29190000891685486, 0.24529999494552612, 0.24169999361038208], [-1.13100004196167, 0.4562999904155731, 0.46230000257492065, 0.45500001311302185, 0.4316999912261963, 0.4268999993801117, 0.42480000853538513, 0.397599995136261, 0.39410001039505005, 0.36640000343322754, 0.31610000133514404, 0.3122999966144562]]}, 'batch_channel_mean': [0.8607000112533569, -0.04560000076889992, -0.01269999984651804, -0.06199999898672104, -0.009600000455975533, 0.1704999953508377, -0.36579999327659607, -0.0020000000949949026], 'batch_channel_std': [1.059499979019165, 0.5946999788284302, 0.5917999744415283, 0.5709999799728394, 0.5871999859809875, 0.9681000113487244, 0.6819999814033508, 0.7301999926567078], 'class_distribution': {'0': 22, '1': 22, '2': 38, '3': 34, '4': 39}, 'feature_range': [-9.981793547102113, 31.866555053073082], 'feature_global_mean': 0.043367023845691036, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}, 'source_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 0, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -0.04390000179409981, -0.06509999930858612, -0.11779999732971191, -0.15219999849796295, -0.17170000076293945, -0.19760000705718994, -0.21850000321865082, -0.22759999334812164, -0.2379000037908554, -0.2531999945640564, -0.2678999900817871], [-1.13100004196167, -0.19740000367164612, -0.21279999613761902, -0.25780001282691956, -0.28760001063346863, -0.3043000102043152, -0.32760000228881836, -0.3458000123500824, -0.3540000021457672, -0.3650999963283539, -0.37959998846054077, -0.3926999866962433]]}, 'batch_channel_mean': [0.8607000112533569, -0.21899999678134918, -0.3481999933719635, -0.1915999948978424, -0.34689998626708984, 1.118899941444397, -0.11599999666213989, 0.016499999910593033], 'batch_channel_std': [1.059499979019165, 0.21160000562667847, 0.17630000412464142, 0.2303999960422516, 0.17829999327659607, 0.9266999959945679, 0.8331000208854675, 0.7063000202178955], 'class_distribution': {'0': 5, '1': 5, '2': 1, '4': 1}, 'feature_range': [-3.203935665790699, 5.1560300164083985], 'feature_global_mean': -0.010901597356338598, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8328, -3.2039, -3.1735, -0.1408]]}, 'target_val': {'batch_shape': [8, 21, 32], 'channels': 21, 'seq_len': 32, 'example_label': 3, 'preview': {'channels': 3, 'timesteps': 12, 'values': [[-1.6202000379562378, -1.388700008392334, -1.1572999954223633, -0.9258000254631042, -0.6944000124931335, -0.4629000127315521, -0.23149999976158142, 0.0, 0.23149999976158142, 0.4629000127315521, 0.6944000124931335, 0.9258000254631042], [-1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653, -1.1741000413894653], [-1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167, -1.13100004196167]]}, 'batch_channel_mean': [0.8607000112533569, 0.27559998631477356, 0.2630000114440918, 0.1655000001192093, 0.2653000056743622, 0.005200000014156103, -0.3278999924659729, -0.6205999851226807], 'batch_channel_std': [1.059499979019165, 0.4851999878883362, 0.47620001435279846, 0.46309998631477356, 0.47749999165534973, 0.9384999871253967, 0.8022000193595886, 0.9699000120162964], 'class_distribution': {'0': 9, '1': 10, '2': 19, '3': 17, '4': 19}, 'feature_range': [-3.426709644883315, 32.206823553376644], 'feature_global_mean': 0.014365731412246173, 'flattened_rows_head': [[-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408], [-1.6202, -1.1741, -1.131, -1.1495, -1.1239, -1.459, -0.8317, -3.2039, -3.1735, -0.1408]]}}, 'dataset_variant': 'argonne_battery', 'feature_names': ['cycle_number', 'energy_charge', 'capacity_charge', 'energy_discharge', 'capacity_discharge', 'cycle_start', 'cycle_duration'], 'source_cathodes': ['5Vspinel'], 'target_cathodes': ['HE5050', 'NMC111', 'NMC532', 'NMC622', 'NMC811'], 'label_column': 'eol_class', 'split_used': 'source_train', 'batch_size_seen': 8, 'channels': 21, 'seq_len': 32}}
12-12 15:29:27 llm_cfg: {'architecture': 'cnn_1d_sa', 'model_name': 'cnn_features_1d_sa', 'self_attention': True, 'sngp': True, 'openmax': False, 'use_unknown_head': False, 'bottleneck': 256, 'dropout': 0.35, 'learning_rate': 0.0005, 'batch_size': 8, 'lambda_src': 0.6, 'warmup_epochs': 10, 'rationale': 'The dataset has 21 channels and short sequence length (32), favoring a CNN with self-attention to capture local and some global dependencies without excessive compute. The domain shift between source and target chemistries suggests benefit from self-attention for adaptation. Dropout at 0.35 balances overfitting risk given label inconsistency. OpenMax or SNGP are less critical since explicit unknown rejection is not emphasized, and the baseline is a deterministic CNN. Moderate bottleneck (256) supports capacity for multi-channel features while maintaining efficiency. Target cathode: HE5050 (high-energy experimental blend). Source cathodes: 5Vspinel (high-voltage spinel (manganese rich)). Source/target chemistries differ → expect domain shift. Evaluated 21 channels × 32-step windows and matched them with cnn_1d_sa capacity. Target fine-tune spans ≈155 cycles versus 41 source cycles, guiding lr=5.00e-04 and dropout=0.35.', '_provider': 'openai', '_raw': '{\n  "model_name": "cnn_features_1d_sa",\n  "self_attention": true,\n  "sngp": false,\n  "openmax": false,\n  "use_unknown_head": false,\n  "bottleneck": 256,\n  "dropout": 0.35,\n  "learning_rate": 0.0005,\n  "batch_size": 8,\n  "lambda_src": 1.0,\n  "warmup_epochs": 10,\n  "rationale": "The dataset has 21 channels and short sequence length (32), favoring a CNN with self-attention to capture local and some global dependencies without excessive compute. The domain shift between source and target chemistries suggests benefit from self-attention for adaptation. Dropout at 0.35 balances overfitting risk given label inconsistency. OpenMax or SNGP are less critical since explicit unknown rejection is not emphasized, and the baseline is a deterministic CNN. Moderate bottleneck (256) supports capacity for multi-channel features while maintaining efficiency."\n}'}
12-12 15:29:27 llm_cfg_stamp: 20251212_131825
12-12 15:29:27 tag: detcnn_20251212_131825
12-12 15:29:27 pretrained_model_path: None
12-12 15:29:30 using 1 cpu
